2025-04-03T18:56:22.376+0000 [INFO] Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: iis_etl.processing.load scheduled__2025-04-02T00:00:00+00:00 [queued]>
2025-04-03T18:56:22.383+0000 [INFO] Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: iis_etl.processing.load scheduled__2025-04-02T00:00:00+00:00 [queued]>
2025-04-03T18:56:22.384+0000 [INFO] Starting attempt 2 of 4
2025-04-03T18:56:22.391+0000 [INFO] Executing <Task(PythonOperator): processing.load> on 2025-04-02 00:00:00+00:00
2025-04-03T18:56:22.395+0000 [INFO] Started process 108 to run task
2025-04-03T18:56:22.397+0000 [INFO] Running: ['airflow', 'tasks', 'run', 'iis_etl', 'processing.load', 'scheduled__2025-04-02T00:00:00+00:00', '--job-id', '23', '--raw', '--subdir', 'DAGS_FOLDER/iis_etl.py', '--cfg-path', '/tmp/tmpfsylvxls']
2025-04-03T18:56:22.399+0000 [INFO] Job 23: Subtask processing.load
2025-04-03T18:56:22.427+0000 [INFO] Running <TaskInstance: iis_etl.processing.load scheduled__2025-04-02T00:00:00+00:00 [running]> on host 467791d2c6c6
2025-04-03T18:56:22.577+0000 [INFO] Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='iis_etl' AIRFLOW_CTX_TASK_ID='processing.load' AIRFLOW_CTX_EXECUTION_DATE='2025-04-02T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-04-02T00:00:00+00:00'
2025-04-03T18:56:22.584+0000 [INFO] Loading 6163 bytes of transformed data
2025-04-03T18:56:22.598+0000 [INFO] Using connection ID 'postgres_iis' for task execution.
2025-04-03T18:56:22.601+0000 [INFO] Connected to database
2025-04-03T18:56:22.613+0000 [ERROR] Database error during load: (psycopg2.errors.UndefinedColumn) column "date" of relation "fact_visits" does not exist
LINE 1: INSERT INTO fact_visits (date, time, datetime_str, "s-ip", "...
                                 ^

[SQL: INSERT INTO fact_visits (date, time, datetime_str, "s-ip", "cs-method", "cs-uri-stem", "cs-uri-query", "s-port", "cs-username", "c-ip", "cs(User-Agent)", "sc-status", "sc-substatus", "sc-win32-status", "time-taken", timestamp, hour, time_period, ip_prefix, user_agent, is_error, is_suspicious) VALUES (%(date_m0)s, %(time_m0)s, %(datetime_str_m0)s, %(s-ip_m0)s, %(cs-method_m0)s, %(cs-uri-stem_m0)s, %(cs-uri-query_m0)s, %(s-port_m0)s, %(cs-username_m0)s, %(c-ip_m0)s, %(csAUser-AgentZ_m0)s, %(sc-status_m0)s, %(sc-substatus_m0)s, %(sc-win32-status_m0)s, %(time-taken_m0)s, %(timestamp_m0)s, %(hour_m0)s, %(time_period_m0)s, %(ip_prefix_m0)s, %(user_agent_m0)s, %(is_error_m0)s, %(is_suspicious_m0)s), (%(date_m1)s, %(time_m1)s, %(datetime_str_m1)s, %(s-ip_m1)s, %(cs-method_m1)s, %(cs-uri-stem_m1)s, %(cs-uri-query_m1)s, %(s-port_m1)s, %(cs-username_m1)s, %(c-ip_m1)s, %(csAUser-AgentZ_m1)s, %(sc-status_m1)s, %(sc-substatus_m1)s, %(sc-win32-status_m1)s, %(time-taken_m1)s, %(timestamp_m1)s, %(hour_m1)s, %(time_period_m1)s, %(ip_prefix_m1)s, %(user_agent_m1)s, %(is_error_m1)s, %(is_suspicious_m1)s), (%(date_m2)s, %(time_m2)s, %(datetime_str_m2)s, %(s-ip_m2)s, %(cs-method_m2)s, %(cs-uri-stem_m2)s, %(cs-uri-query_m2)s, %(s-port_m2)s, %(cs-username_m2)s, %(c-ip_m2)s, %(csAUser-AgentZ_m2)s, %(sc-status_m2)s, %(sc-substatus_m2)s, %(sc-win32-status_m2)s, %(time-taken_m2)s, %(timestamp_m2)s, %(hour_m2)s, %(time_period_m2)s, %(ip_prefix_m2)s, %(user_agent_m2)s, %(is_error_m2)s, %(is_suspicious_m2)s), (%(date_m3)s, %(time_m3)s, %(datetime_str_m3)s, %(s-ip_m3)s, %(cs-method_m3)s, %(cs-uri-stem_m3)s, %(cs-uri-query_m3)s, %(s-port_m3)s, %(cs-username_m3)s, %(c-ip_m3)s, %(csAUser-AgentZ_m3)s, %(sc-status_m3)s, %(sc-substatus_m3)s, %(sc-win32-status_m3)s, %(time-taken_m3)s, %(timestamp_m3)s, %(hour_m3)s, %(time_period_m3)s, %(ip_prefix_m3)s, %(user_agent_m3)s, %(is_error_m3)s, %(is_suspicious_m3)s), (%(date_m4)s, %(time_m4)s, %(datetime_str_m4)s, %(s-ip_m4)s, %(cs-method_m4)s, %(cs-uri-stem_m4)s, %(cs-uri-query_m4)s, %(s-port_m4)s, %(cs-username_m4)s, %(c-ip_m4)s, %(csAUser-AgentZ_m4)s, %(sc-status_m4)s, %(sc-substatus_m4)s, %(sc-win32-status_m4)s, %(time-taken_m4)s, %(timestamp_m4)s, %(hour_m4)s, %(time_period_m4)s, %(ip_prefix_m4)s, %(user_agent_m4)s, %(is_error_m4)s, %(is_suspicious_m4)s), (%(date_m5)s, %(time_m5)s, %(datetime_str_m5)s, %(s-ip_m5)s, %(cs-method_m5)s, %(cs-uri-stem_m5)s, %(cs-uri-query_m5)s, %(s-port_m5)s, %(cs-username_m5)s, %(c-ip_m5)s, %(csAUser-AgentZ_m5)s, %(sc-status_m5)s, %(sc-substatus_m5)s, %(sc-win32-status_m5)s, %(time-taken_m5)s, %(timestamp_m5)s, %(hour_m5)s, %(time_period_m5)s, %(ip_prefix_m5)s, %(user_agent_m5)s, %(is_error_m5)s, %(is_suspicious_m5)s), (%(date_m6)s, %(time_m6)s, %(datetime_str_m6)s, %(s-ip_m6)s, %(cs-method_m6)s, %(cs-uri-stem_m6)s, %(cs-uri-query_m6)s, %(s-port_m6)s, %(cs-username_m6)s, %(c-ip_m6)s, %(csAUser-AgentZ_m6)s, %(sc-status_m6)s, %(sc-substatus_m6)s, %(sc-win32-status_m6)s, %(time-taken_m6)s, %(timestamp_m6)s, %(hour_m6)s, %(time_period_m6)s, %(ip_prefix_m6)s, %(user_agent_m6)s, %(is_error_m6)s, %(is_suspicious_m6)s), (%(date_m7)s, %(time_m7)s, %(datetime_str_m7)s, %(s-ip_m7)s, %(cs-method_m7)s, %(cs-uri-stem_m7)s, %(cs-uri-query_m7)s, %(s-port_m7)s, %(cs-username_m7)s, %(c-ip_m7)s, %(csAUser-AgentZ_m7)s, %(sc-status_m7)s, %(sc-substatus_m7)s, %(sc-win32-status_m7)s, %(time-taken_m7)s, %(timestamp_m7)s, %(hour_m7)s, %(time_period_m7)s, %(ip_prefix_m7)s, %(user_agent_m7)s, %(is_error_m7)s, %(is_suspicious_m7)s), (%(date_m8)s, %(time_m8)s, %(datetime_str_m8)s, %(s-ip_m8)s, %(cs-method_m8)s, %(cs-uri-stem_m8)s, %(cs-uri-query_m8)s, %(s-port_m8)s, %(cs-username_m8)s, %(c-ip_m8)s, %(csAUser-AgentZ_m8)s, %(sc-status_m8)s, %(sc-substatus_m8)s, %(sc-win32-status_m8)s, %(time-taken_m8)s, %(timestamp_m8)s, %(hour_m8)s, %(time_period_m8)s, %(ip_prefix_m8)s, %(user_agent_m8)s, %(is_error_m8)s, %(is_suspicious_m8)s), (%(date_m9)s, %(time_m9)s, %(datetime_str_m9)s, %(s-ip_m9)s, %(cs-method_m9)s, %(cs-uri-stem_m9)s, %(cs-uri-query_m9)s, %(s-port_m9)s, %(cs-username_m9)s, %(c-ip_m9)s, %(csAUser-AgentZ_m9)s, %(sc-status_m9)s, %(sc-substatus_m9)s, %(sc-win32-status_m9)s, %(time-taken_m9)s, %(timestamp_m9)s, %(hour_m9)s, %(time_period_m9)s, %(ip_prefix_m9)s, %(user_agent_m9)s, %(is_error_m9)s, %(is_suspicious_m9)s), (%(date_m10)s, %(time_m10)s, %(datetime_str_m10)s, %(s-ip_m10)s, %(cs-method_m10)s, %(cs-uri-stem_m10)s, %(cs-uri-query_m10)s, %(s-port_m10)s, %(cs-username_m10)s, %(c-ip_m10)s, %(csAUser-AgentZ_m10)s, %(sc-status_m10)s, %(sc-substatus_m10)s, %(sc-win32-status_m10)s, %(time-taken_m10)s, %(timestamp_m10)s, %(hour_m10)s, %(time_period_m10)s, %(ip_prefix_m10)s, %(user_agent_m10)s, %(is_error_m10)s, %(is_suspicious_m10)s)]
[parameters: {'date_m0': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m0': '01:40:40', 'datetime_str_m0': '2009-10-24 01:40:40', 's-ip_m0': '134.36.36.75', 'cs-method_m0': 'HEAD', 'cs-uri-stem_m0': '/', 'cs-uri-query_m0': '-', 's-port_m0': 80, 'cs-username_m0': '-', 'c-ip_m0': '205.178.184.153', 'csAUser-AgentZ_m0': 'Mozilla/5.0+(Windows;+U;+Windows+NT+5.1;+en-US;+rv:1.8.1.12)+Gecko/20080201+Firefox/2.0.0.12', 'sc-status_m0': 200, 'sc-substatus_m0': 0, 'sc-win32-status_m0': 0, 'time-taken_m0': 186, 'timestamp_m0': datetime.datetime(2009, 10, 24, 1, 40, 40, tzinfo=<UTC>), 'hour_m0': 1, 'time_period_m0': 'Night', 'ip_prefix_m0': 205.178, 'user_agent_m0': 'Other / Windows / Firefox 2.0.0', 'is_error_m0': False, 'is_suspicious_m0': False, 'date_m1': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m1': '01:40:43', 'datetime_str_m1': '2009-10-24 01:40:43', 's-ip_m1': '134.36.36.75', 'cs-method_m1': 'GET', 'cs-uri-stem_m1': '/', 'cs-uri-query_m1': '-', 's-port_m1': 80, 'cs-username_m1': '-', 'c-ip_m1': '205.178.184.153', 'csAUser-AgentZ_m1': 'Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+5.1;+.NET+CLR+1.1.4322;+.NET+CLR+2.0.50727)', 'sc-status_m1': 200, 'sc-substatus_m1': 0, 'sc-win32-status_m1': 0, 'time-taken_m1': 111, 'timestamp_m1': datetime.datetime(2009, 10, 24, 1, 40, 43, tzinfo=<UTC>), 'hour_m1': 1, 'time_period_m1': 'Night', 'ip_prefix_m1': 205.178, 'user_agent_m1': 'Other / Windows / Other', 'is_error_m1': False, 'is_suspicious_m1': False, 'date_m2': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m2': '01:40:43', 'datetime_str_m2': '2009-10-24 01:40:43', 's-ip_m2': '134.36.36.75', 'cs-method_m2': 'GET', 'cs-uri-stem_m2': '/Darwin/Home.aspx', 'cs-uri-query_m2': '-', 's-port_m2': 80, 'cs-username_m2': '-', 'c-ip_m2': '205.178.184.153', 'csAUser-AgentZ_m2': 'Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.2;+SV1;+.NET+CLR+1.1.4322;+.NET+CLR+2.0.50727)', 'sc-status_m2': 404, 'sc-substatus_m2': 0, 'sc-win32-status_m2': 0, 'time-taken_m2': 443, 'timestamp_m2': datetime.datetime(2009, 10, 24, 1, 40, 43, tzinfo=<UTC>), 'hour_m2': 1, 'time_period_m2': 'Night', 'ip_prefix_m2': 205.178, 'user_agent_m2': 'Other / Windows / Other', 'is_error_m2': True, 'is_suspicious_m2': False, 'date_m3': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m3': '01:41:17', 'datetime_str_m3': '2009-10-24 01:41:17', 's-ip_m3': '134.36.36.75', 'cs-method_m3': 'GET', 'cs-uri-stem_m3': '/', 'cs-uri-query_m3': '-', 's-port_m3': 80, 'cs-username_m3': '-', 'c-ip_m3': '205.178.184.153', 'csAUser-AgentZ_m3': 'Mozilla/5.0+(Windows;+U;+Windows+NT+5.1;+en-US;+rv:1.8.1.12)+Gecko/20080201+Firefox/2.0.0.12', 'sc-status_m3': 200, 'sc-substatus_m3': 0, 'sc-win32-status_m3': 0, 'time-taken_m3': 112, 'timestamp_m3': datetime.datetime(2009, 10, 24, 1, 41, 17, tzinfo=<UTC>), 'hour_m3': 1, 'time_period_m3': 'Night', 'ip_prefix_m3': 205.178, 'user_agent_m3': 'Other / Windows / Firefox 2.0.0', 'is_error_m3': False, 'is_suspicious_m3': False, 'date_m4': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m4': '01:41:17', 'datetime_str_m4': '2009-10-24 01:41:17', 's-ip_m4': '134.36.36.75', 'cs-method_m4': 'GET', 'cs-uri-stem_m4': '/robots.txt', 'cs-uri-query_m4': '-', 's-port_m4': 80, 'cs-username_m4': '-', 'c-ip_m4': '205.178.184.153', 'csAUser-AgentZ_m4': 'Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+5.1;+.NET+CLR+1.1.4322;+.NET+CLR+2.0.50727)', 'sc-status_m4': 404, 'sc-substatus_m4': 0, 'sc-win32-status_m4': 2, 'time-taken_m4': 112, 'timestamp_m4': datetime.datetime(2009, 10, 24, 1, 41, 17, tzinfo=<UTC>), 'hour_m4': 1, 'time_period_m4': 'Night', 'ip_prefix_m4': 205.178, 'user_agent_m4': 'Other / Windows / Other', 'is_error_m4': True, 'is_suspicious_m4': False, 'date_m5': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m5': '08:34:52', 'datetime_str_m5': '2009-10-24 08:34:52', 's-ip_m5': '134.36.36.75', 'cs-method_m5': 'GET', 'cs-uri-stem_m5': '/abc.php', 'cs-uri-query_m5': 'auth=REDACTED&strPassword=PQWHUP_DDZEQ&nLoginId=43', 's-port_m5': 80, 'cs-username_m5': '-', 'c-ip_m5': '91.212.127.100', 'csAUser-AgentZ_m5': 'Mozilla/5.0+(Windows;+U;+Windows+NT+5.0;+en-US;+rv:1.8.1.12)+Gecko/20080201+Firefox/2.0.0.12', 'sc-status_m5': 404, 'sc-substatus_m5': 0, 'sc-win32-status_m5': 64, 'time-taken_m5': 92, 'timestamp_m5': datetime.datetime(2009, 10, 24, 8, 34, 52, tzinfo=<UTC>), 'hour_m5': 8, 'time_period_m5': 'Morning', 'ip_prefix_m5': 91.212, 'user_agent_m5': 'Other / Windows / Firefox 2.0.0', 'is_error_m5': True, 'is_suspicious_m5': False, 'date_m6': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m6': '11:51:22', 'datetime_str_m6': '2009-10-24 11:51:22', 's-ip_m6': '134.36.36.75', 'cs-method_m6': 'GET', 'cs-uri-stem_m6': '/phpMyAdmin/scripts/setup.php', 'cs-uri-query_m6': '-', 's-port_m6': 80, 'cs-username_m6': '-', 'c-ip_m6': '204.244.11.121', 'csAUser-AgentZ_m6': 'Plesk', 'sc-status_m6': 404, 'sc-substatus_m6': 0, 'sc-win32-status_m6': 2, 'time-taken_m6': 227, 'timestamp_m6': datetime.datetime(2009, 10, 24, 11, 51, 22, tzinfo=<UTC>), 'hour_m6': 11, 'time_period_m6': 'Morning', 'ip_prefix_m6': 204.244, 'user_agent_m6': 'Other / Other / Other', 'is_error_m6': True, 'is_suspicious_m6': True, 'date_m7': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m7': '11:51:58', 'datetime_str_m7': '2009-10-24 11:51:58', 's-ip_m7': '134.36.36.75', 'cs-method_m7': 'GET', 'cs-uri-stem_m7': '/phpmyadmin/scripts/setup.php', 'cs-uri-query_m7': '-', 's-port_m7': 80, 'cs-username_m7': '-', 'c-ip_m7': '204.244.11.121', 'csAUser-AgentZ_m7': 'Plesk', 'sc-status_m7': 404, 'sc-substatus_m7': 0, 'sc-win32-status_m7': 2, 'time-taken_m7': 157, 'timestamp_m7': datetime.datetime(2009, 10, 24, 11, 51, 58, tzinfo=<UTC>), 'hour_m7': 11, 'time_period_m7': 'Morning', 'ip_prefix_m7': 204.244, 'user_agent_m7': 'Other / Other / Other', 'is_error_m7': True, 'is_suspicious_m7': True, 'date_m8': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m8': '11:52:33', 'datetime_str_m8': '2009-10-24 11:52:33', 's-ip_m8': '134.36.36.75', 'cs-method_m8': 'GET', 'cs-uri-stem_m8': '/pma/scripts/setup.php', 'cs-uri-query_m8': '-', 's-port_m8': 80, 'cs-username_m8': '-', 'c-ip_m8': '204.244.11.121', 'csAUser-AgentZ_m8': 'Plesk', 'sc-status_m8': 404, 'sc-substatus_m8': 0, 'sc-win32-status_m8': 2, 'time-taken_m8': 157, 'timestamp_m8': datetime.datetime(2009, 10, 24, 11, 52, 33, tzinfo=<UTC>), 'hour_m8': 11, 'time_period_m8': 'Morning', 'ip_prefix_m8': 204.244, 'user_agent_m8': 'Other / Other / Other', 'is_error_m8': True, 'is_suspicious_m8': False, 'date_m9': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m9': '11:53:09', 'datetime_str_m9': '2009-10-24 11:53:09', 's-ip_m9': '134.36.36.75', 'cs-method_m9': 'GET', 'cs-uri-stem_m9': '/mysql/scripts/setup.php', 'cs-uri-query_m9': '-', 's-port_m9': 80, 'cs-username_m9': '-', 'c-ip_m9': '204.244.11.121', 'csAUser-AgentZ_m9': 'Plesk', 'sc-status_m9': 404, 'sc-substatus_m9': 0, 'sc-win32-status_m9': 2, 'time-taken_m9': 158, 'timestamp_m9': datetime.datetime(2009, 10, 24, 11, 53, 9, tzinfo=<UTC>), 'hour_m9': 11, 'time_period_m9': 'Morning', 'ip_prefix_m9': 204.244, 'user_agent_m9': 'Other / Other / Other', 'is_error_m9': True, 'is_suspicious_m9': False, 'date_m10': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m10': '11:53:44', 'datetime_str_m10': '2009-10-24 11:53:44', 's-ip_m10': '134.36.36.75', 'cs-method_m10': 'GET', 'cs-uri-stem_m10': '/admin/scripts/setup.php', 'cs-uri-query_m10': '-', 's-port_m10': 80, 'cs-username_m10': '-', 'c-ip_m10': '204.244.11.121', 'csAUser-AgentZ_m10': 'Plesk', 'sc-status_m10': 404, 'sc-substatus_m10': 0, 'sc-win32-status_m10': 2, 'time-taken_m10': 157, 'timestamp_m10': datetime.datetime(2009, 10, 24, 11, 53, 44, tzinfo=<UTC>), 'hour_m10': 11, 'time_period_m10': 'Morning', 'ip_prefix_m10': 204.244, 'user_agent_m10': 'Other / Other / Other', 'is_error_m10': True, 'is_suspicious_m10': False}]
(Background on this error at: https://sqlalche.me/e/14/f405)
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1901, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column "date" of relation "fact_visits" does not exist
LINE 1: INSERT INTO fact_visits (date, time, datetime_str, "s-ip", "...
                                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/airflow/dags/iis_etl.py", line 307, in load
    chunksize=1000
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1770, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1350, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1340, in insert_records
    table.insert(chunksize=chunksize, method=method)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 967, in insert
    exec_insert(conn, keys, chunk_iter)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 893, in _execute_insert_multi
    conn.execute(self.table.insert(data))
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1380, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 335, in _execute_on_connection
    self, multiparams, params, execution_options
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1582, in _execute_clauseelement
    cache_hit=cache_hit,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1944, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2125, in _handle_dbapi_exception
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1901, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "date" of relation "fact_visits" does not exist
LINE 1: INSERT INTO fact_visits (date, time, datetime_str, "s-ip", "...
                                 ^

[SQL: INSERT INTO fact_visits (date, time, datetime_str, "s-ip", "cs-method", "cs-uri-stem", "cs-uri-query", "s-port", "cs-username", "c-ip", "cs(User-Agent)", "sc-status", "sc-substatus", "sc-win32-status", "time-taken", timestamp, hour, time_period, ip_prefix, user_agent, is_error, is_suspicious) VALUES (%(date_m0)s, %(time_m0)s, %(datetime_str_m0)s, %(s-ip_m0)s, %(cs-method_m0)s, %(cs-uri-stem_m0)s, %(cs-uri-query_m0)s, %(s-port_m0)s, %(cs-username_m0)s, %(c-ip_m0)s, %(csAUser-AgentZ_m0)s, %(sc-status_m0)s, %(sc-substatus_m0)s, %(sc-win32-status_m0)s, %(time-taken_m0)s, %(timestamp_m0)s, %(hour_m0)s, %(time_period_m0)s, %(ip_prefix_m0)s, %(user_agent_m0)s, %(is_error_m0)s, %(is_suspicious_m0)s), (%(date_m1)s, %(time_m1)s, %(datetime_str_m1)s, %(s-ip_m1)s, %(cs-method_m1)s, %(cs-uri-stem_m1)s, %(cs-uri-query_m1)s, %(s-port_m1)s, %(cs-username_m1)s, %(c-ip_m1)s, %(csAUser-AgentZ_m1)s, %(sc-status_m1)s, %(sc-substatus_m1)s, %(sc-win32-status_m1)s, %(time-taken_m1)s, %(timestamp_m1)s, %(hour_m1)s, %(time_period_m1)s, %(ip_prefix_m1)s, %(user_agent_m1)s, %(is_error_m1)s, %(is_suspicious_m1)s), (%(date_m2)s, %(time_m2)s, %(datetime_str_m2)s, %(s-ip_m2)s, %(cs-method_m2)s, %(cs-uri-stem_m2)s, %(cs-uri-query_m2)s, %(s-port_m2)s, %(cs-username_m2)s, %(c-ip_m2)s, %(csAUser-AgentZ_m2)s, %(sc-status_m2)s, %(sc-substatus_m2)s, %(sc-win32-status_m2)s, %(time-taken_m2)s, %(timestamp_m2)s, %(hour_m2)s, %(time_period_m2)s, %(ip_prefix_m2)s, %(user_agent_m2)s, %(is_error_m2)s, %(is_suspicious_m2)s), (%(date_m3)s, %(time_m3)s, %(datetime_str_m3)s, %(s-ip_m3)s, %(cs-method_m3)s, %(cs-uri-stem_m3)s, %(cs-uri-query_m3)s, %(s-port_m3)s, %(cs-username_m3)s, %(c-ip_m3)s, %(csAUser-AgentZ_m3)s, %(sc-status_m3)s, %(sc-substatus_m3)s, %(sc-win32-status_m3)s, %(time-taken_m3)s, %(timestamp_m3)s, %(hour_m3)s, %(time_period_m3)s, %(ip_prefix_m3)s, %(user_agent_m3)s, %(is_error_m3)s, %(is_suspicious_m3)s), (%(date_m4)s, %(time_m4)s, %(datetime_str_m4)s, %(s-ip_m4)s, %(cs-method_m4)s, %(cs-uri-stem_m4)s, %(cs-uri-query_m4)s, %(s-port_m4)s, %(cs-username_m4)s, %(c-ip_m4)s, %(csAUser-AgentZ_m4)s, %(sc-status_m4)s, %(sc-substatus_m4)s, %(sc-win32-status_m4)s, %(time-taken_m4)s, %(timestamp_m4)s, %(hour_m4)s, %(time_period_m4)s, %(ip_prefix_m4)s, %(user_agent_m4)s, %(is_error_m4)s, %(is_suspicious_m4)s), (%(date_m5)s, %(time_m5)s, %(datetime_str_m5)s, %(s-ip_m5)s, %(cs-method_m5)s, %(cs-uri-stem_m5)s, %(cs-uri-query_m5)s, %(s-port_m5)s, %(cs-username_m5)s, %(c-ip_m5)s, %(csAUser-AgentZ_m5)s, %(sc-status_m5)s, %(sc-substatus_m5)s, %(sc-win32-status_m5)s, %(time-taken_m5)s, %(timestamp_m5)s, %(hour_m5)s, %(time_period_m5)s, %(ip_prefix_m5)s, %(user_agent_m5)s, %(is_error_m5)s, %(is_suspicious_m5)s), (%(date_m6)s, %(time_m6)s, %(datetime_str_m6)s, %(s-ip_m6)s, %(cs-method_m6)s, %(cs-uri-stem_m6)s, %(cs-uri-query_m6)s, %(s-port_m6)s, %(cs-username_m6)s, %(c-ip_m6)s, %(csAUser-AgentZ_m6)s, %(sc-status_m6)s, %(sc-substatus_m6)s, %(sc-win32-status_m6)s, %(time-taken_m6)s, %(timestamp_m6)s, %(hour_m6)s, %(time_period_m6)s, %(ip_prefix_m6)s, %(user_agent_m6)s, %(is_error_m6)s, %(is_suspicious_m6)s), (%(date_m7)s, %(time_m7)s, %(datetime_str_m7)s, %(s-ip_m7)s, %(cs-method_m7)s, %(cs-uri-stem_m7)s, %(cs-uri-query_m7)s, %(s-port_m7)s, %(cs-username_m7)s, %(c-ip_m7)s, %(csAUser-AgentZ_m7)s, %(sc-status_m7)s, %(sc-substatus_m7)s, %(sc-win32-status_m7)s, %(time-taken_m7)s, %(timestamp_m7)s, %(hour_m7)s, %(time_period_m7)s, %(ip_prefix_m7)s, %(user_agent_m7)s, %(is_error_m7)s, %(is_suspicious_m7)s), (%(date_m8)s, %(time_m8)s, %(datetime_str_m8)s, %(s-ip_m8)s, %(cs-method_m8)s, %(cs-uri-stem_m8)s, %(cs-uri-query_m8)s, %(s-port_m8)s, %(cs-username_m8)s, %(c-ip_m8)s, %(csAUser-AgentZ_m8)s, %(sc-status_m8)s, %(sc-substatus_m8)s, %(sc-win32-status_m8)s, %(time-taken_m8)s, %(timestamp_m8)s, %(hour_m8)s, %(time_period_m8)s, %(ip_prefix_m8)s, %(user_agent_m8)s, %(is_error_m8)s, %(is_suspicious_m8)s), (%(date_m9)s, %(time_m9)s, %(datetime_str_m9)s, %(s-ip_m9)s, %(cs-method_m9)s, %(cs-uri-stem_m9)s, %(cs-uri-query_m9)s, %(s-port_m9)s, %(cs-username_m9)s, %(c-ip_m9)s, %(csAUser-AgentZ_m9)s, %(sc-status_m9)s, %(sc-substatus_m9)s, %(sc-win32-status_m9)s, %(time-taken_m9)s, %(timestamp_m9)s, %(hour_m9)s, %(time_period_m9)s, %(ip_prefix_m9)s, %(user_agent_m9)s, %(is_error_m9)s, %(is_suspicious_m9)s), (%(date_m10)s, %(time_m10)s, %(datetime_str_m10)s, %(s-ip_m10)s, %(cs-method_m10)s, %(cs-uri-stem_m10)s, %(cs-uri-query_m10)s, %(s-port_m10)s, %(cs-username_m10)s, %(c-ip_m10)s, %(csAUser-AgentZ_m10)s, %(sc-status_m10)s, %(sc-substatus_m10)s, %(sc-win32-status_m10)s, %(time-taken_m10)s, %(timestamp_m10)s, %(hour_m10)s, %(time_period_m10)s, %(ip_prefix_m10)s, %(user_agent_m10)s, %(is_error_m10)s, %(is_suspicious_m10)s)]
[parameters: {'date_m0': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m0': '01:40:40', 'datetime_str_m0': '2009-10-24 01:40:40', 's-ip_m0': '134.36.36.75', 'cs-method_m0': 'HEAD', 'cs-uri-stem_m0': '/', 'cs-uri-query_m0': '-', 's-port_m0': 80, 'cs-username_m0': '-', 'c-ip_m0': '205.178.184.153', 'csAUser-AgentZ_m0': 'Mozilla/5.0+(Windows;+U;+Windows+NT+5.1;+en-US;+rv:1.8.1.12)+Gecko/20080201+Firefox/2.0.0.12', 'sc-status_m0': 200, 'sc-substatus_m0': 0, 'sc-win32-status_m0': 0, 'time-taken_m0': 186, 'timestamp_m0': datetime.datetime(2009, 10, 24, 1, 40, 40, tzinfo=<UTC>), 'hour_m0': 1, 'time_period_m0': 'Night', 'ip_prefix_m0': 205.178, 'user_agent_m0': 'Other / Windows / Firefox 2.0.0', 'is_error_m0': False, 'is_suspicious_m0': False, 'date_m1': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m1': '01:40:43', 'datetime_str_m1': '2009-10-24 01:40:43', 's-ip_m1': '134.36.36.75', 'cs-method_m1': 'GET', 'cs-uri-stem_m1': '/', 'cs-uri-query_m1': '-', 's-port_m1': 80, 'cs-username_m1': '-', 'c-ip_m1': '205.178.184.153', 'csAUser-AgentZ_m1': 'Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+5.1;+.NET+CLR+1.1.4322;+.NET+CLR+2.0.50727)', 'sc-status_m1': 200, 'sc-substatus_m1': 0, 'sc-win32-status_m1': 0, 'time-taken_m1': 111, 'timestamp_m1': datetime.datetime(2009, 10, 24, 1, 40, 43, tzinfo=<UTC>), 'hour_m1': 1, 'time_period_m1': 'Night', 'ip_prefix_m1': 205.178, 'user_agent_m1': 'Other / Windows / Other', 'is_error_m1': False, 'is_suspicious_m1': False, 'date_m2': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m2': '01:40:43', 'datetime_str_m2': '2009-10-24 01:40:43', 's-ip_m2': '134.36.36.75', 'cs-method_m2': 'GET', 'cs-uri-stem_m2': '/Darwin/Home.aspx', 'cs-uri-query_m2': '-', 's-port_m2': 80, 'cs-username_m2': '-', 'c-ip_m2': '205.178.184.153', 'csAUser-AgentZ_m2': 'Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.2;+SV1;+.NET+CLR+1.1.4322;+.NET+CLR+2.0.50727)', 'sc-status_m2': 404, 'sc-substatus_m2': 0, 'sc-win32-status_m2': 0, 'time-taken_m2': 443, 'timestamp_m2': datetime.datetime(2009, 10, 24, 1, 40, 43, tzinfo=<UTC>), 'hour_m2': 1, 'time_period_m2': 'Night', 'ip_prefix_m2': 205.178, 'user_agent_m2': 'Other / Windows / Other', 'is_error_m2': True, 'is_suspicious_m2': False, 'date_m3': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m3': '01:41:17', 'datetime_str_m3': '2009-10-24 01:41:17', 's-ip_m3': '134.36.36.75', 'cs-method_m3': 'GET', 'cs-uri-stem_m3': '/', 'cs-uri-query_m3': '-', 's-port_m3': 80, 'cs-username_m3': '-', 'c-ip_m3': '205.178.184.153', 'csAUser-AgentZ_m3': 'Mozilla/5.0+(Windows;+U;+Windows+NT+5.1;+en-US;+rv:1.8.1.12)+Gecko/20080201+Firefox/2.0.0.12', 'sc-status_m3': 200, 'sc-substatus_m3': 0, 'sc-win32-status_m3': 0, 'time-taken_m3': 112, 'timestamp_m3': datetime.datetime(2009, 10, 24, 1, 41, 17, tzinfo=<UTC>), 'hour_m3': 1, 'time_period_m3': 'Night', 'ip_prefix_m3': 205.178, 'user_agent_m3': 'Other / Windows / Firefox 2.0.0', 'is_error_m3': False, 'is_suspicious_m3': False, 'date_m4': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m4': '01:41:17', 'datetime_str_m4': '2009-10-24 01:41:17', 's-ip_m4': '134.36.36.75', 'cs-method_m4': 'GET', 'cs-uri-stem_m4': '/robots.txt', 'cs-uri-query_m4': '-', 's-port_m4': 80, 'cs-username_m4': '-', 'c-ip_m4': '205.178.184.153', 'csAUser-AgentZ_m4': 'Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+5.1;+.NET+CLR+1.1.4322;+.NET+CLR+2.0.50727)', 'sc-status_m4': 404, 'sc-substatus_m4': 0, 'sc-win32-status_m4': 2, 'time-taken_m4': 112, 'timestamp_m4': datetime.datetime(2009, 10, 24, 1, 41, 17, tzinfo=<UTC>), 'hour_m4': 1, 'time_period_m4': 'Night', 'ip_prefix_m4': 205.178, 'user_agent_m4': 'Other / Windows / Other', 'is_error_m4': True, 'is_suspicious_m4': False, 'date_m5': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m5': '08:34:52', 'datetime_str_m5': '2009-10-24 08:34:52', 's-ip_m5': '134.36.36.75', 'cs-method_m5': 'GET', 'cs-uri-stem_m5': '/abc.php', 'cs-uri-query_m5': 'auth=REDACTED&strPassword=PQWHUP_DDZEQ&nLoginId=43', 's-port_m5': 80, 'cs-username_m5': '-', 'c-ip_m5': '91.212.127.100', 'csAUser-AgentZ_m5': 'Mozilla/5.0+(Windows;+U;+Windows+NT+5.0;+en-US;+rv:1.8.1.12)+Gecko/20080201+Firefox/2.0.0.12', 'sc-status_m5': 404, 'sc-substatus_m5': 0, 'sc-win32-status_m5': 64, 'time-taken_m5': 92, 'timestamp_m5': datetime.datetime(2009, 10, 24, 8, 34, 52, tzinfo=<UTC>), 'hour_m5': 8, 'time_period_m5': 'Morning', 'ip_prefix_m5': 91.212, 'user_agent_m5': 'Other / Windows / Firefox 2.0.0', 'is_error_m5': True, 'is_suspicious_m5': False, 'date_m6': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m6': '11:51:22', 'datetime_str_m6': '2009-10-24 11:51:22', 's-ip_m6': '134.36.36.75', 'cs-method_m6': 'GET', 'cs-uri-stem_m6': '/phpMyAdmin/scripts/setup.php', 'cs-uri-query_m6': '-', 's-port_m6': 80, 'cs-username_m6': '-', 'c-ip_m6': '204.244.11.121', 'csAUser-AgentZ_m6': 'Plesk', 'sc-status_m6': 404, 'sc-substatus_m6': 0, 'sc-win32-status_m6': 2, 'time-taken_m6': 227, 'timestamp_m6': datetime.datetime(2009, 10, 24, 11, 51, 22, tzinfo=<UTC>), 'hour_m6': 11, 'time_period_m6': 'Morning', 'ip_prefix_m6': 204.244, 'user_agent_m6': 'Other / Other / Other', 'is_error_m6': True, 'is_suspicious_m6': True, 'date_m7': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m7': '11:51:58', 'datetime_str_m7': '2009-10-24 11:51:58', 's-ip_m7': '134.36.36.75', 'cs-method_m7': 'GET', 'cs-uri-stem_m7': '/phpmyadmin/scripts/setup.php', 'cs-uri-query_m7': '-', 's-port_m7': 80, 'cs-username_m7': '-', 'c-ip_m7': '204.244.11.121', 'csAUser-AgentZ_m7': 'Plesk', 'sc-status_m7': 404, 'sc-substatus_m7': 0, 'sc-win32-status_m7': 2, 'time-taken_m7': 157, 'timestamp_m7': datetime.datetime(2009, 10, 24, 11, 51, 58, tzinfo=<UTC>), 'hour_m7': 11, 'time_period_m7': 'Morning', 'ip_prefix_m7': 204.244, 'user_agent_m7': 'Other / Other / Other', 'is_error_m7': True, 'is_suspicious_m7': True, 'date_m8': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m8': '11:52:33', 'datetime_str_m8': '2009-10-24 11:52:33', 's-ip_m8': '134.36.36.75', 'cs-method_m8': 'GET', 'cs-uri-stem_m8': '/pma/scripts/setup.php', 'cs-uri-query_m8': '-', 's-port_m8': 80, 'cs-username_m8': '-', 'c-ip_m8': '204.244.11.121', 'csAUser-AgentZ_m8': 'Plesk', 'sc-status_m8': 404, 'sc-substatus_m8': 0, 'sc-win32-status_m8': 2, 'time-taken_m8': 157, 'timestamp_m8': datetime.datetime(2009, 10, 24, 11, 52, 33, tzinfo=<UTC>), 'hour_m8': 11, 'time_period_m8': 'Morning', 'ip_prefix_m8': 204.244, 'user_agent_m8': 'Other / Other / Other', 'is_error_m8': True, 'is_suspicious_m8': False, 'date_m9': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m9': '11:53:09', 'datetime_str_m9': '2009-10-24 11:53:09', 's-ip_m9': '134.36.36.75', 'cs-method_m9': 'GET', 'cs-uri-stem_m9': '/mysql/scripts/setup.php', 'cs-uri-query_m9': '-', 's-port_m9': 80, 'cs-username_m9': '-', 'c-ip_m9': '204.244.11.121', 'csAUser-AgentZ_m9': 'Plesk', 'sc-status_m9': 404, 'sc-substatus_m9': 0, 'sc-win32-status_m9': 2, 'time-taken_m9': 158, 'timestamp_m9': datetime.datetime(2009, 10, 24, 11, 53, 9, tzinfo=<UTC>), 'hour_m9': 11, 'time_period_m9': 'Morning', 'ip_prefix_m9': 204.244, 'user_agent_m9': 'Other / Other / Other', 'is_error_m9': True, 'is_suspicious_m9': False, 'date_m10': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m10': '11:53:44', 'datetime_str_m10': '2009-10-24 11:53:44', 's-ip_m10': '134.36.36.75', 'cs-method_m10': 'GET', 'cs-uri-stem_m10': '/admin/scripts/setup.php', 'cs-uri-query_m10': '-', 's-port_m10': 80, 'cs-username_m10': '-', 'c-ip_m10': '204.244.11.121', 'csAUser-AgentZ_m10': 'Plesk', 'sc-status_m10': 404, 'sc-substatus_m10': 0, 'sc-win32-status_m10': 2, 'time-taken_m10': 157, 'timestamp_m10': datetime.datetime(2009, 10, 24, 11, 53, 44, tzinfo=<UTC>), 'hour_m10': 11, 'time_period_m10': 'Morning', 'ip_prefix_m10': 204.244, 'user_agent_m10': 'Other / Other / Other', 'is_error_m10': True, 'is_suspicious_m10': False}]
(Background on this error at: https://sqlalche.me/e/14/f405)
2025-04-03T18:56:22.619+0000 [ERROR] Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1901, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column "date" of relation "fact_visits" does not exist
LINE 1: INSERT INTO fact_visits (date, time, datetime_str, "s-ip", "...
                                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 181, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 198, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/iis_etl.py", line 307, in load
    chunksize=1000
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 2882, in to_sql
    method=method,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 728, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1770, in to_sql
    **engine_kwargs,
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1350, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 1340, in insert_records
    table.insert(chunksize=chunksize, method=method)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 967, in insert
    exec_insert(conn, keys, chunk_iter)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/io/sql.py", line 893, in _execute_insert_multi
    conn.execute(self.table.insert(data))
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1380, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/sql/elements.py", line 335, in _execute_on_connection
    self, multiparams, params, execution_options
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1582, in _execute_clauseelement
    cache_hit=cache_hit,
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1944, in _execute_context
    e, statement, parameters, cursor, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 2125, in _handle_dbapi_exception
    sqlalchemy_exception, with_traceback=exc_info[2], from_=e
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/base.py", line 1901, in _execute_context
    cursor, statement, parameters, context
  File "/home/airflow/.local/lib/python3.7/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "date" of relation "fact_visits" does not exist
LINE 1: INSERT INTO fact_visits (date, time, datetime_str, "s-ip", "...
                                 ^

[SQL: INSERT INTO fact_visits (date, time, datetime_str, "s-ip", "cs-method", "cs-uri-stem", "cs-uri-query", "s-port", "cs-username", "c-ip", "cs(User-Agent)", "sc-status", "sc-substatus", "sc-win32-status", "time-taken", timestamp, hour, time_period, ip_prefix, user_agent, is_error, is_suspicious) VALUES (%(date_m0)s, %(time_m0)s, %(datetime_str_m0)s, %(s-ip_m0)s, %(cs-method_m0)s, %(cs-uri-stem_m0)s, %(cs-uri-query_m0)s, %(s-port_m0)s, %(cs-username_m0)s, %(c-ip_m0)s, %(csAUser-AgentZ_m0)s, %(sc-status_m0)s, %(sc-substatus_m0)s, %(sc-win32-status_m0)s, %(time-taken_m0)s, %(timestamp_m0)s, %(hour_m0)s, %(time_period_m0)s, %(ip_prefix_m0)s, %(user_agent_m0)s, %(is_error_m0)s, %(is_suspicious_m0)s), (%(date_m1)s, %(time_m1)s, %(datetime_str_m1)s, %(s-ip_m1)s, %(cs-method_m1)s, %(cs-uri-stem_m1)s, %(cs-uri-query_m1)s, %(s-port_m1)s, %(cs-username_m1)s, %(c-ip_m1)s, %(csAUser-AgentZ_m1)s, %(sc-status_m1)s, %(sc-substatus_m1)s, %(sc-win32-status_m1)s, %(time-taken_m1)s, %(timestamp_m1)s, %(hour_m1)s, %(time_period_m1)s, %(ip_prefix_m1)s, %(user_agent_m1)s, %(is_error_m1)s, %(is_suspicious_m1)s), (%(date_m2)s, %(time_m2)s, %(datetime_str_m2)s, %(s-ip_m2)s, %(cs-method_m2)s, %(cs-uri-stem_m2)s, %(cs-uri-query_m2)s, %(s-port_m2)s, %(cs-username_m2)s, %(c-ip_m2)s, %(csAUser-AgentZ_m2)s, %(sc-status_m2)s, %(sc-substatus_m2)s, %(sc-win32-status_m2)s, %(time-taken_m2)s, %(timestamp_m2)s, %(hour_m2)s, %(time_period_m2)s, %(ip_prefix_m2)s, %(user_agent_m2)s, %(is_error_m2)s, %(is_suspicious_m2)s), (%(date_m3)s, %(time_m3)s, %(datetime_str_m3)s, %(s-ip_m3)s, %(cs-method_m3)s, %(cs-uri-stem_m3)s, %(cs-uri-query_m3)s, %(s-port_m3)s, %(cs-username_m3)s, %(c-ip_m3)s, %(csAUser-AgentZ_m3)s, %(sc-status_m3)s, %(sc-substatus_m3)s, %(sc-win32-status_m3)s, %(time-taken_m3)s, %(timestamp_m3)s, %(hour_m3)s, %(time_period_m3)s, %(ip_prefix_m3)s, %(user_agent_m3)s, %(is_error_m3)s, %(is_suspicious_m3)s), (%(date_m4)s, %(time_m4)s, %(datetime_str_m4)s, %(s-ip_m4)s, %(cs-method_m4)s, %(cs-uri-stem_m4)s, %(cs-uri-query_m4)s, %(s-port_m4)s, %(cs-username_m4)s, %(c-ip_m4)s, %(csAUser-AgentZ_m4)s, %(sc-status_m4)s, %(sc-substatus_m4)s, %(sc-win32-status_m4)s, %(time-taken_m4)s, %(timestamp_m4)s, %(hour_m4)s, %(time_period_m4)s, %(ip_prefix_m4)s, %(user_agent_m4)s, %(is_error_m4)s, %(is_suspicious_m4)s), (%(date_m5)s, %(time_m5)s, %(datetime_str_m5)s, %(s-ip_m5)s, %(cs-method_m5)s, %(cs-uri-stem_m5)s, %(cs-uri-query_m5)s, %(s-port_m5)s, %(cs-username_m5)s, %(c-ip_m5)s, %(csAUser-AgentZ_m5)s, %(sc-status_m5)s, %(sc-substatus_m5)s, %(sc-win32-status_m5)s, %(time-taken_m5)s, %(timestamp_m5)s, %(hour_m5)s, %(time_period_m5)s, %(ip_prefix_m5)s, %(user_agent_m5)s, %(is_error_m5)s, %(is_suspicious_m5)s), (%(date_m6)s, %(time_m6)s, %(datetime_str_m6)s, %(s-ip_m6)s, %(cs-method_m6)s, %(cs-uri-stem_m6)s, %(cs-uri-query_m6)s, %(s-port_m6)s, %(cs-username_m6)s, %(c-ip_m6)s, %(csAUser-AgentZ_m6)s, %(sc-status_m6)s, %(sc-substatus_m6)s, %(sc-win32-status_m6)s, %(time-taken_m6)s, %(timestamp_m6)s, %(hour_m6)s, %(time_period_m6)s, %(ip_prefix_m6)s, %(user_agent_m6)s, %(is_error_m6)s, %(is_suspicious_m6)s), (%(date_m7)s, %(time_m7)s, %(datetime_str_m7)s, %(s-ip_m7)s, %(cs-method_m7)s, %(cs-uri-stem_m7)s, %(cs-uri-query_m7)s, %(s-port_m7)s, %(cs-username_m7)s, %(c-ip_m7)s, %(csAUser-AgentZ_m7)s, %(sc-status_m7)s, %(sc-substatus_m7)s, %(sc-win32-status_m7)s, %(time-taken_m7)s, %(timestamp_m7)s, %(hour_m7)s, %(time_period_m7)s, %(ip_prefix_m7)s, %(user_agent_m7)s, %(is_error_m7)s, %(is_suspicious_m7)s), (%(date_m8)s, %(time_m8)s, %(datetime_str_m8)s, %(s-ip_m8)s, %(cs-method_m8)s, %(cs-uri-stem_m8)s, %(cs-uri-query_m8)s, %(s-port_m8)s, %(cs-username_m8)s, %(c-ip_m8)s, %(csAUser-AgentZ_m8)s, %(sc-status_m8)s, %(sc-substatus_m8)s, %(sc-win32-status_m8)s, %(time-taken_m8)s, %(timestamp_m8)s, %(hour_m8)s, %(time_period_m8)s, %(ip_prefix_m8)s, %(user_agent_m8)s, %(is_error_m8)s, %(is_suspicious_m8)s), (%(date_m9)s, %(time_m9)s, %(datetime_str_m9)s, %(s-ip_m9)s, %(cs-method_m9)s, %(cs-uri-stem_m9)s, %(cs-uri-query_m9)s, %(s-port_m9)s, %(cs-username_m9)s, %(c-ip_m9)s, %(csAUser-AgentZ_m9)s, %(sc-status_m9)s, %(sc-substatus_m9)s, %(sc-win32-status_m9)s, %(time-taken_m9)s, %(timestamp_m9)s, %(hour_m9)s, %(time_period_m9)s, %(ip_prefix_m9)s, %(user_agent_m9)s, %(is_error_m9)s, %(is_suspicious_m9)s), (%(date_m10)s, %(time_m10)s, %(datetime_str_m10)s, %(s-ip_m10)s, %(cs-method_m10)s, %(cs-uri-stem_m10)s, %(cs-uri-query_m10)s, %(s-port_m10)s, %(cs-username_m10)s, %(c-ip_m10)s, %(csAUser-AgentZ_m10)s, %(sc-status_m10)s, %(sc-substatus_m10)s, %(sc-win32-status_m10)s, %(time-taken_m10)s, %(timestamp_m10)s, %(hour_m10)s, %(time_period_m10)s, %(ip_prefix_m10)s, %(user_agent_m10)s, %(is_error_m10)s, %(is_suspicious_m10)s)]
[parameters: {'date_m0': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m0': '01:40:40', 'datetime_str_m0': '2009-10-24 01:40:40', 's-ip_m0': '134.36.36.75', 'cs-method_m0': 'HEAD', 'cs-uri-stem_m0': '/', 'cs-uri-query_m0': '-', 's-port_m0': 80, 'cs-username_m0': '-', 'c-ip_m0': '205.178.184.153', 'csAUser-AgentZ_m0': 'Mozilla/5.0+(Windows;+U;+Windows+NT+5.1;+en-US;+rv:1.8.1.12)+Gecko/20080201+Firefox/2.0.0.12', 'sc-status_m0': 200, 'sc-substatus_m0': 0, 'sc-win32-status_m0': 0, 'time-taken_m0': 186, 'timestamp_m0': datetime.datetime(2009, 10, 24, 1, 40, 40, tzinfo=<UTC>), 'hour_m0': 1, 'time_period_m0': 'Night', 'ip_prefix_m0': 205.178, 'user_agent_m0': 'Other / Windows / Firefox 2.0.0', 'is_error_m0': False, 'is_suspicious_m0': False, 'date_m1': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m1': '01:40:43', 'datetime_str_m1': '2009-10-24 01:40:43', 's-ip_m1': '134.36.36.75', 'cs-method_m1': 'GET', 'cs-uri-stem_m1': '/', 'cs-uri-query_m1': '-', 's-port_m1': 80, 'cs-username_m1': '-', 'c-ip_m1': '205.178.184.153', 'csAUser-AgentZ_m1': 'Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+5.1;+.NET+CLR+1.1.4322;+.NET+CLR+2.0.50727)', 'sc-status_m1': 200, 'sc-substatus_m1': 0, 'sc-win32-status_m1': 0, 'time-taken_m1': 111, 'timestamp_m1': datetime.datetime(2009, 10, 24, 1, 40, 43, tzinfo=<UTC>), 'hour_m1': 1, 'time_period_m1': 'Night', 'ip_prefix_m1': 205.178, 'user_agent_m1': 'Other / Windows / Other', 'is_error_m1': False, 'is_suspicious_m1': False, 'date_m2': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m2': '01:40:43', 'datetime_str_m2': '2009-10-24 01:40:43', 's-ip_m2': '134.36.36.75', 'cs-method_m2': 'GET', 'cs-uri-stem_m2': '/Darwin/Home.aspx', 'cs-uri-query_m2': '-', 's-port_m2': 80, 'cs-username_m2': '-', 'c-ip_m2': '205.178.184.153', 'csAUser-AgentZ_m2': 'Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.2;+SV1;+.NET+CLR+1.1.4322;+.NET+CLR+2.0.50727)', 'sc-status_m2': 404, 'sc-substatus_m2': 0, 'sc-win32-status_m2': 0, 'time-taken_m2': 443, 'timestamp_m2': datetime.datetime(2009, 10, 24, 1, 40, 43, tzinfo=<UTC>), 'hour_m2': 1, 'time_period_m2': 'Night', 'ip_prefix_m2': 205.178, 'user_agent_m2': 'Other / Windows / Other', 'is_error_m2': True, 'is_suspicious_m2': False, 'date_m3': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m3': '01:41:17', 'datetime_str_m3': '2009-10-24 01:41:17', 's-ip_m3': '134.36.36.75', 'cs-method_m3': 'GET', 'cs-uri-stem_m3': '/', 'cs-uri-query_m3': '-', 's-port_m3': 80, 'cs-username_m3': '-', 'c-ip_m3': '205.178.184.153', 'csAUser-AgentZ_m3': 'Mozilla/5.0+(Windows;+U;+Windows+NT+5.1;+en-US;+rv:1.8.1.12)+Gecko/20080201+Firefox/2.0.0.12', 'sc-status_m3': 200, 'sc-substatus_m3': 0, 'sc-win32-status_m3': 0, 'time-taken_m3': 112, 'timestamp_m3': datetime.datetime(2009, 10, 24, 1, 41, 17, tzinfo=<UTC>), 'hour_m3': 1, 'time_period_m3': 'Night', 'ip_prefix_m3': 205.178, 'user_agent_m3': 'Other / Windows / Firefox 2.0.0', 'is_error_m3': False, 'is_suspicious_m3': False, 'date_m4': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m4': '01:41:17', 'datetime_str_m4': '2009-10-24 01:41:17', 's-ip_m4': '134.36.36.75', 'cs-method_m4': 'GET', 'cs-uri-stem_m4': '/robots.txt', 'cs-uri-query_m4': '-', 's-port_m4': 80, 'cs-username_m4': '-', 'c-ip_m4': '205.178.184.153', 'csAUser-AgentZ_m4': 'Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+5.1;+.NET+CLR+1.1.4322;+.NET+CLR+2.0.50727)', 'sc-status_m4': 404, 'sc-substatus_m4': 0, 'sc-win32-status_m4': 2, 'time-taken_m4': 112, 'timestamp_m4': datetime.datetime(2009, 10, 24, 1, 41, 17, tzinfo=<UTC>), 'hour_m4': 1, 'time_period_m4': 'Night', 'ip_prefix_m4': 205.178, 'user_agent_m4': 'Other / Windows / Other', 'is_error_m4': True, 'is_suspicious_m4': False, 'date_m5': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m5': '08:34:52', 'datetime_str_m5': '2009-10-24 08:34:52', 's-ip_m5': '134.36.36.75', 'cs-method_m5': 'GET', 'cs-uri-stem_m5': '/abc.php', 'cs-uri-query_m5': 'auth=REDACTED&strPassword=PQWHUP_DDZEQ&nLoginId=43', 's-port_m5': 80, 'cs-username_m5': '-', 'c-ip_m5': '91.212.127.100', 'csAUser-AgentZ_m5': 'Mozilla/5.0+(Windows;+U;+Windows+NT+5.0;+en-US;+rv:1.8.1.12)+Gecko/20080201+Firefox/2.0.0.12', 'sc-status_m5': 404, 'sc-substatus_m5': 0, 'sc-win32-status_m5': 64, 'time-taken_m5': 92, 'timestamp_m5': datetime.datetime(2009, 10, 24, 8, 34, 52, tzinfo=<UTC>), 'hour_m5': 8, 'time_period_m5': 'Morning', 'ip_prefix_m5': 91.212, 'user_agent_m5': 'Other / Windows / Firefox 2.0.0', 'is_error_m5': True, 'is_suspicious_m5': False, 'date_m6': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m6': '11:51:22', 'datetime_str_m6': '2009-10-24 11:51:22', 's-ip_m6': '134.36.36.75', 'cs-method_m6': 'GET', 'cs-uri-stem_m6': '/phpMyAdmin/scripts/setup.php', 'cs-uri-query_m6': '-', 's-port_m6': 80, 'cs-username_m6': '-', 'c-ip_m6': '204.244.11.121', 'csAUser-AgentZ_m6': 'Plesk', 'sc-status_m6': 404, 'sc-substatus_m6': 0, 'sc-win32-status_m6': 2, 'time-taken_m6': 227, 'timestamp_m6': datetime.datetime(2009, 10, 24, 11, 51, 22, tzinfo=<UTC>), 'hour_m6': 11, 'time_period_m6': 'Morning', 'ip_prefix_m6': 204.244, 'user_agent_m6': 'Other / Other / Other', 'is_error_m6': True, 'is_suspicious_m6': True, 'date_m7': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m7': '11:51:58', 'datetime_str_m7': '2009-10-24 11:51:58', 's-ip_m7': '134.36.36.75', 'cs-method_m7': 'GET', 'cs-uri-stem_m7': '/phpmyadmin/scripts/setup.php', 'cs-uri-query_m7': '-', 's-port_m7': 80, 'cs-username_m7': '-', 'c-ip_m7': '204.244.11.121', 'csAUser-AgentZ_m7': 'Plesk', 'sc-status_m7': 404, 'sc-substatus_m7': 0, 'sc-win32-status_m7': 2, 'time-taken_m7': 157, 'timestamp_m7': datetime.datetime(2009, 10, 24, 11, 51, 58, tzinfo=<UTC>), 'hour_m7': 11, 'time_period_m7': 'Morning', 'ip_prefix_m7': 204.244, 'user_agent_m7': 'Other / Other / Other', 'is_error_m7': True, 'is_suspicious_m7': True, 'date_m8': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m8': '11:52:33', 'datetime_str_m8': '2009-10-24 11:52:33', 's-ip_m8': '134.36.36.75', 'cs-method_m8': 'GET', 'cs-uri-stem_m8': '/pma/scripts/setup.php', 'cs-uri-query_m8': '-', 's-port_m8': 80, 'cs-username_m8': '-', 'c-ip_m8': '204.244.11.121', 'csAUser-AgentZ_m8': 'Plesk', 'sc-status_m8': 404, 'sc-substatus_m8': 0, 'sc-win32-status_m8': 2, 'time-taken_m8': 157, 'timestamp_m8': datetime.datetime(2009, 10, 24, 11, 52, 33, tzinfo=<UTC>), 'hour_m8': 11, 'time_period_m8': 'Morning', 'ip_prefix_m8': 204.244, 'user_agent_m8': 'Other / Other / Other', 'is_error_m8': True, 'is_suspicious_m8': False, 'date_m9': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m9': '11:53:09', 'datetime_str_m9': '2009-10-24 11:53:09', 's-ip_m9': '134.36.36.75', 'cs-method_m9': 'GET', 'cs-uri-stem_m9': '/mysql/scripts/setup.php', 'cs-uri-query_m9': '-', 's-port_m9': 80, 'cs-username_m9': '-', 'c-ip_m9': '204.244.11.121', 'csAUser-AgentZ_m9': 'Plesk', 'sc-status_m9': 404, 'sc-substatus_m9': 0, 'sc-win32-status_m9': 2, 'time-taken_m9': 158, 'timestamp_m9': datetime.datetime(2009, 10, 24, 11, 53, 9, tzinfo=<UTC>), 'hour_m9': 11, 'time_period_m9': 'Morning', 'ip_prefix_m9': 204.244, 'user_agent_m9': 'Other / Other / Other', 'is_error_m9': True, 'is_suspicious_m9': False, 'date_m10': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m10': '11:53:44', 'datetime_str_m10': '2009-10-24 11:53:44', 's-ip_m10': '134.36.36.75', 'cs-method_m10': 'GET', 'cs-uri-stem_m10': '/admin/scripts/setup.php', 'cs-uri-query_m10': '-', 's-port_m10': 80, 'cs-username_m10': '-', 'c-ip_m10': '204.244.11.121', 'csAUser-AgentZ_m10': 'Plesk', 'sc-status_m10': 404, 'sc-substatus_m10': 0, 'sc-win32-status_m10': 2, 'time-taken_m10': 157, 'timestamp_m10': datetime.datetime(2009, 10, 24, 11, 53, 44, tzinfo=<UTC>), 'hour_m10': 11, 'time_period_m10': 'Morning', 'ip_prefix_m10': 204.244, 'user_agent_m10': 'Other / Other / Other', 'is_error_m10': True, 'is_suspicious_m10': False}]
(Background on this error at: https://sqlalche.me/e/14/f405)
2025-04-03T18:56:22.624+0000 [INFO] Marking task as UP_FOR_RETRY. dag_id=iis_etl, task_id=processing.load, execution_date=20250402T000000, start_date=20250403T185622, end_date=20250403T185622
2025-04-03T18:56:22.631+0000 [ERROR] Failed to execute job 23 for task processing.load ((psycopg2.errors.UndefinedColumn) column "date" of relation "fact_visits" does not exist
LINE 1: INSERT INTO fact_visits (date, time, datetime_str, "s-ip", "...
                                 ^

[SQL: INSERT INTO fact_visits (date, time, datetime_str, "s-ip", "cs-method", "cs-uri-stem", "cs-uri-query", "s-port", "cs-username", "c-ip", "cs(User-Agent)", "sc-status", "sc-substatus", "sc-win32-status", "time-taken", timestamp, hour, time_period, ip_prefix, user_agent, is_error, is_suspicious) VALUES (%(date_m0)s, %(time_m0)s, %(datetime_str_m0)s, %(s-ip_m0)s, %(cs-method_m0)s, %(cs-uri-stem_m0)s, %(cs-uri-query_m0)s, %(s-port_m0)s, %(cs-username_m0)s, %(c-ip_m0)s, %(csAUser-AgentZ_m0)s, %(sc-status_m0)s, %(sc-substatus_m0)s, %(sc-win32-status_m0)s, %(time-taken_m0)s, %(timestamp_m0)s, %(hour_m0)s, %(time_period_m0)s, %(ip_prefix_m0)s, %(user_agent_m0)s, %(is_error_m0)s, %(is_suspicious_m0)s), (%(date_m1)s, %(time_m1)s, %(datetime_str_m1)s, %(s-ip_m1)s, %(cs-method_m1)s, %(cs-uri-stem_m1)s, %(cs-uri-query_m1)s, %(s-port_m1)s, %(cs-username_m1)s, %(c-ip_m1)s, %(csAUser-AgentZ_m1)s, %(sc-status_m1)s, %(sc-substatus_m1)s, %(sc-win32-status_m1)s, %(time-taken_m1)s, %(timestamp_m1)s, %(hour_m1)s, %(time_period_m1)s, %(ip_prefix_m1)s, %(user_agent_m1)s, %(is_error_m1)s, %(is_suspicious_m1)s), (%(date_m2)s, %(time_m2)s, %(datetime_str_m2)s, %(s-ip_m2)s, %(cs-method_m2)s, %(cs-uri-stem_m2)s, %(cs-uri-query_m2)s, %(s-port_m2)s, %(cs-username_m2)s, %(c-ip_m2)s, %(csAUser-AgentZ_m2)s, %(sc-status_m2)s, %(sc-substatus_m2)s, %(sc-win32-status_m2)s, %(time-taken_m2)s, %(timestamp_m2)s, %(hour_m2)s, %(time_period_m2)s, %(ip_prefix_m2)s, %(user_agent_m2)s, %(is_error_m2)s, %(is_suspicious_m2)s), (%(date_m3)s, %(time_m3)s, %(datetime_str_m3)s, %(s-ip_m3)s, %(cs-method_m3)s, %(cs-uri-stem_m3)s, %(cs-uri-query_m3)s, %(s-port_m3)s, %(cs-username_m3)s, %(c-ip_m3)s, %(csAUser-AgentZ_m3)s, %(sc-status_m3)s, %(sc-substatus_m3)s, %(sc-win32-status_m3)s, %(time-taken_m3)s, %(timestamp_m3)s, %(hour_m3)s, %(time_period_m3)s, %(ip_prefix_m3)s, %(user_agent_m3)s, %(is_error_m3)s, %(is_suspicious_m3)s), (%(date_m4)s, %(time_m4)s, %(datetime_str_m4)s, %(s-ip_m4)s, %(cs-method_m4)s, %(cs-uri-stem_m4)s, %(cs-uri-query_m4)s, %(s-port_m4)s, %(cs-username_m4)s, %(c-ip_m4)s, %(csAUser-AgentZ_m4)s, %(sc-status_m4)s, %(sc-substatus_m4)s, %(sc-win32-status_m4)s, %(time-taken_m4)s, %(timestamp_m4)s, %(hour_m4)s, %(time_period_m4)s, %(ip_prefix_m4)s, %(user_agent_m4)s, %(is_error_m4)s, %(is_suspicious_m4)s), (%(date_m5)s, %(time_m5)s, %(datetime_str_m5)s, %(s-ip_m5)s, %(cs-method_m5)s, %(cs-uri-stem_m5)s, %(cs-uri-query_m5)s, %(s-port_m5)s, %(cs-username_m5)s, %(c-ip_m5)s, %(csAUser-AgentZ_m5)s, %(sc-status_m5)s, %(sc-substatus_m5)s, %(sc-win32-status_m5)s, %(time-taken_m5)s, %(timestamp_m5)s, %(hour_m5)s, %(time_period_m5)s, %(ip_prefix_m5)s, %(user_agent_m5)s, %(is_error_m5)s, %(is_suspicious_m5)s), (%(date_m6)s, %(time_m6)s, %(datetime_str_m6)s, %(s-ip_m6)s, %(cs-method_m6)s, %(cs-uri-stem_m6)s, %(cs-uri-query_m6)s, %(s-port_m6)s, %(cs-username_m6)s, %(c-ip_m6)s, %(csAUser-AgentZ_m6)s, %(sc-status_m6)s, %(sc-substatus_m6)s, %(sc-win32-status_m6)s, %(time-taken_m6)s, %(timestamp_m6)s, %(hour_m6)s, %(time_period_m6)s, %(ip_prefix_m6)s, %(user_agent_m6)s, %(is_error_m6)s, %(is_suspicious_m6)s), (%(date_m7)s, %(time_m7)s, %(datetime_str_m7)s, %(s-ip_m7)s, %(cs-method_m7)s, %(cs-uri-stem_m7)s, %(cs-uri-query_m7)s, %(s-port_m7)s, %(cs-username_m7)s, %(c-ip_m7)s, %(csAUser-AgentZ_m7)s, %(sc-status_m7)s, %(sc-substatus_m7)s, %(sc-win32-status_m7)s, %(time-taken_m7)s, %(timestamp_m7)s, %(hour_m7)s, %(time_period_m7)s, %(ip_prefix_m7)s, %(user_agent_m7)s, %(is_error_m7)s, %(is_suspicious_m7)s), (%(date_m8)s, %(time_m8)s, %(datetime_str_m8)s, %(s-ip_m8)s, %(cs-method_m8)s, %(cs-uri-stem_m8)s, %(cs-uri-query_m8)s, %(s-port_m8)s, %(cs-username_m8)s, %(c-ip_m8)s, %(csAUser-AgentZ_m8)s, %(sc-status_m8)s, %(sc-substatus_m8)s, %(sc-win32-status_m8)s, %(time-taken_m8)s, %(timestamp_m8)s, %(hour_m8)s, %(time_period_m8)s, %(ip_prefix_m8)s, %(user_agent_m8)s, %(is_error_m8)s, %(is_suspicious_m8)s), (%(date_m9)s, %(time_m9)s, %(datetime_str_m9)s, %(s-ip_m9)s, %(cs-method_m9)s, %(cs-uri-stem_m9)s, %(cs-uri-query_m9)s, %(s-port_m9)s, %(cs-username_m9)s, %(c-ip_m9)s, %(csAUser-AgentZ_m9)s, %(sc-status_m9)s, %(sc-substatus_m9)s, %(sc-win32-status_m9)s, %(time-taken_m9)s, %(timestamp_m9)s, %(hour_m9)s, %(time_period_m9)s, %(ip_prefix_m9)s, %(user_agent_m9)s, %(is_error_m9)s, %(is_suspicious_m9)s), (%(date_m10)s, %(time_m10)s, %(datetime_str_m10)s, %(s-ip_m10)s, %(cs-method_m10)s, %(cs-uri-stem_m10)s, %(cs-uri-query_m10)s, %(s-port_m10)s, %(cs-username_m10)s, %(c-ip_m10)s, %(csAUser-AgentZ_m10)s, %(sc-status_m10)s, %(sc-substatus_m10)s, %(sc-win32-status_m10)s, %(time-taken_m10)s, %(timestamp_m10)s, %(hour_m10)s, %(time_period_m10)s, %(ip_prefix_m10)s, %(user_agent_m10)s, %(is_error_m10)s, %(is_suspicious_m10)s)]
[parameters: {'date_m0': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m0': '01:40:40', 'datetime_str_m0': '2009-10-24 01:40:40', 's-ip_m0': '134.36.36.75', 'cs-method_m0': 'HEAD', 'cs-uri-stem_m0': '/', 'cs-uri-query_m0': '-', 's-port_m0': 80, 'cs-username_m0': '-', 'c-ip_m0': '205.178.184.153', 'csAUser-AgentZ_m0': 'Mozilla/5.0+(Windows;+U;+Windows+NT+5.1;+en-US;+rv:1.8.1.12)+Gecko/20080201+Firefox/2.0.0.12', 'sc-status_m0': 200, 'sc-substatus_m0': 0, 'sc-win32-status_m0': 0, 'time-taken_m0': 186, 'timestamp_m0': datetime.datetime(2009, 10, 24, 1, 40, 40, tzinfo=<UTC>), 'hour_m0': 1, 'time_period_m0': 'Night', 'ip_prefix_m0': 205.178, 'user_agent_m0': 'Other / Windows / Firefox 2.0.0', 'is_error_m0': False, 'is_suspicious_m0': False, 'date_m1': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m1': '01:40:43', 'datetime_str_m1': '2009-10-24 01:40:43', 's-ip_m1': '134.36.36.75', 'cs-method_m1': 'GET', 'cs-uri-stem_m1': '/', 'cs-uri-query_m1': '-', 's-port_m1': 80, 'cs-username_m1': '-', 'c-ip_m1': '205.178.184.153', 'csAUser-AgentZ_m1': 'Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+5.1;+.NET+CLR+1.1.4322;+.NET+CLR+2.0.50727)', 'sc-status_m1': 200, 'sc-substatus_m1': 0, 'sc-win32-status_m1': 0, 'time-taken_m1': 111, 'timestamp_m1': datetime.datetime(2009, 10, 24, 1, 40, 43, tzinfo=<UTC>), 'hour_m1': 1, 'time_period_m1': 'Night', 'ip_prefix_m1': 205.178, 'user_agent_m1': 'Other / Windows / Other', 'is_error_m1': False, 'is_suspicious_m1': False, 'date_m2': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m2': '01:40:43', 'datetime_str_m2': '2009-10-24 01:40:43', 's-ip_m2': '134.36.36.75', 'cs-method_m2': 'GET', 'cs-uri-stem_m2': '/Darwin/Home.aspx', 'cs-uri-query_m2': '-', 's-port_m2': 80, 'cs-username_m2': '-', 'c-ip_m2': '205.178.184.153', 'csAUser-AgentZ_m2': 'Mozilla/4.0+(compatible;+MSIE+6.0;+Windows+NT+5.2;+SV1;+.NET+CLR+1.1.4322;+.NET+CLR+2.0.50727)', 'sc-status_m2': 404, 'sc-substatus_m2': 0, 'sc-win32-status_m2': 0, 'time-taken_m2': 443, 'timestamp_m2': datetime.datetime(2009, 10, 24, 1, 40, 43, tzinfo=<UTC>), 'hour_m2': 1, 'time_period_m2': 'Night', 'ip_prefix_m2': 205.178, 'user_agent_m2': 'Other / Windows / Other', 'is_error_m2': True, 'is_suspicious_m2': False, 'date_m3': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m3': '01:41:17', 'datetime_str_m3': '2009-10-24 01:41:17', 's-ip_m3': '134.36.36.75', 'cs-method_m3': 'GET', 'cs-uri-stem_m3': '/', 'cs-uri-query_m3': '-', 's-port_m3': 80, 'cs-username_m3': '-', 'c-ip_m3': '205.178.184.153', 'csAUser-AgentZ_m3': 'Mozilla/5.0+(Windows;+U;+Windows+NT+5.1;+en-US;+rv:1.8.1.12)+Gecko/20080201+Firefox/2.0.0.12', 'sc-status_m3': 200, 'sc-substatus_m3': 0, 'sc-win32-status_m3': 0, 'time-taken_m3': 112, 'timestamp_m3': datetime.datetime(2009, 10, 24, 1, 41, 17, tzinfo=<UTC>), 'hour_m3': 1, 'time_period_m3': 'Night', 'ip_prefix_m3': 205.178, 'user_agent_m3': 'Other / Windows / Firefox 2.0.0', 'is_error_m3': False, 'is_suspicious_m3': False, 'date_m4': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m4': '01:41:17', 'datetime_str_m4': '2009-10-24 01:41:17', 's-ip_m4': '134.36.36.75', 'cs-method_m4': 'GET', 'cs-uri-stem_m4': '/robots.txt', 'cs-uri-query_m4': '-', 's-port_m4': 80, 'cs-username_m4': '-', 'c-ip_m4': '205.178.184.153', 'csAUser-AgentZ_m4': 'Mozilla/4.0+(compatible;+MSIE+7.0;+Windows+NT+5.1;+.NET+CLR+1.1.4322;+.NET+CLR+2.0.50727)', 'sc-status_m4': 404, 'sc-substatus_m4': 0, 'sc-win32-status_m4': 2, 'time-taken_m4': 112, 'timestamp_m4': datetime.datetime(2009, 10, 24, 1, 41, 17, tzinfo=<UTC>), 'hour_m4': 1, 'time_period_m4': 'Night', 'ip_prefix_m4': 205.178, 'user_agent_m4': 'Other / Windows / Other', 'is_error_m4': True, 'is_suspicious_m4': False, 'date_m5': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m5': '08:34:52', 'datetime_str_m5': '2009-10-24 08:34:52', 's-ip_m5': '134.36.36.75', 'cs-method_m5': 'GET', 'cs-uri-stem_m5': '/abc.php', 'cs-uri-query_m5': 'auth=REDACTED&strPassword=PQWHUP_DDZEQ&nLoginId=43', 's-port_m5': 80, 'cs-username_m5': '-', 'c-ip_m5': '91.212.127.100', 'csAUser-AgentZ_m5': 'Mozilla/5.0+(Windows;+U;+Windows+NT+5.0;+en-US;+rv:1.8.1.12)+Gecko/20080201+Firefox/2.0.0.12', 'sc-status_m5': 404, 'sc-substatus_m5': 0, 'sc-win32-status_m5': 64, 'time-taken_m5': 92, 'timestamp_m5': datetime.datetime(2009, 10, 24, 8, 34, 52, tzinfo=<UTC>), 'hour_m5': 8, 'time_period_m5': 'Morning', 'ip_prefix_m5': 91.212, 'user_agent_m5': 'Other / Windows / Firefox 2.0.0', 'is_error_m5': True, 'is_suspicious_m5': False, 'date_m6': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m6': '11:51:22', 'datetime_str_m6': '2009-10-24 11:51:22', 's-ip_m6': '134.36.36.75', 'cs-method_m6': 'GET', 'cs-uri-stem_m6': '/phpMyAdmin/scripts/setup.php', 'cs-uri-query_m6': '-', 's-port_m6': 80, 'cs-username_m6': '-', 'c-ip_m6': '204.244.11.121', 'csAUser-AgentZ_m6': 'Plesk', 'sc-status_m6': 404, 'sc-substatus_m6': 0, 'sc-win32-status_m6': 2, 'time-taken_m6': 227, 'timestamp_m6': datetime.datetime(2009, 10, 24, 11, 51, 22, tzinfo=<UTC>), 'hour_m6': 11, 'time_period_m6': 'Morning', 'ip_prefix_m6': 204.244, 'user_agent_m6': 'Other / Other / Other', 'is_error_m6': True, 'is_suspicious_m6': True, 'date_m7': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m7': '11:51:58', 'datetime_str_m7': '2009-10-24 11:51:58', 's-ip_m7': '134.36.36.75', 'cs-method_m7': 'GET', 'cs-uri-stem_m7': '/phpmyadmin/scripts/setup.php', 'cs-uri-query_m7': '-', 's-port_m7': 80, 'cs-username_m7': '-', 'c-ip_m7': '204.244.11.121', 'csAUser-AgentZ_m7': 'Plesk', 'sc-status_m7': 404, 'sc-substatus_m7': 0, 'sc-win32-status_m7': 2, 'time-taken_m7': 157, 'timestamp_m7': datetime.datetime(2009, 10, 24, 11, 51, 58, tzinfo=<UTC>), 'hour_m7': 11, 'time_period_m7': 'Morning', 'ip_prefix_m7': 204.244, 'user_agent_m7': 'Other / Other / Other', 'is_error_m7': True, 'is_suspicious_m7': True, 'date_m8': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m8': '11:52:33', 'datetime_str_m8': '2009-10-24 11:52:33', 's-ip_m8': '134.36.36.75', 'cs-method_m8': 'GET', 'cs-uri-stem_m8': '/pma/scripts/setup.php', 'cs-uri-query_m8': '-', 's-port_m8': 80, 'cs-username_m8': '-', 'c-ip_m8': '204.244.11.121', 'csAUser-AgentZ_m8': 'Plesk', 'sc-status_m8': 404, 'sc-substatus_m8': 0, 'sc-win32-status_m8': 2, 'time-taken_m8': 157, 'timestamp_m8': datetime.datetime(2009, 10, 24, 11, 52, 33, tzinfo=<UTC>), 'hour_m8': 11, 'time_period_m8': 'Morning', 'ip_prefix_m8': 204.244, 'user_agent_m8': 'Other / Other / Other', 'is_error_m8': True, 'is_suspicious_m8': False, 'date_m9': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m9': '11:53:09', 'datetime_str_m9': '2009-10-24 11:53:09', 's-ip_m9': '134.36.36.75', 'cs-method_m9': 'GET', 'cs-uri-stem_m9': '/mysql/scripts/setup.php', 'cs-uri-query_m9': '-', 's-port_m9': 80, 'cs-username_m9': '-', 'c-ip_m9': '204.244.11.121', 'csAUser-AgentZ_m9': 'Plesk', 'sc-status_m9': 404, 'sc-substatus_m9': 0, 'sc-win32-status_m9': 2, 'time-taken_m9': 158, 'timestamp_m9': datetime.datetime(2009, 10, 24, 11, 53, 9, tzinfo=<UTC>), 'hour_m9': 11, 'time_period_m9': 'Morning', 'ip_prefix_m9': 204.244, 'user_agent_m9': 'Other / Other / Other', 'is_error_m9': True, 'is_suspicious_m9': False, 'date_m10': datetime.datetime(2009, 10, 24, 0, 0, tzinfo=<UTC>), 'time_m10': '11:53:44', 'datetime_str_m10': '2009-10-24 11:53:44', 's-ip_m10': '134.36.36.75', 'cs-method_m10': 'GET', 'cs-uri-stem_m10': '/admin/scripts/setup.php', 'cs-uri-query_m10': '-', 's-port_m10': 80, 'cs-username_m10': '-', 'c-ip_m10': '204.244.11.121', 'csAUser-AgentZ_m10': 'Plesk', 'sc-status_m10': 404, 'sc-substatus_m10': 0, 'sc-win32-status_m10': 2, 'time-taken_m10': 157, 'timestamp_m10': datetime.datetime(2009, 10, 24, 11, 53, 44, tzinfo=<UTC>), 'hour_m10': 11, 'time_period_m10': 'Morning', 'ip_prefix_m10': 204.244, 'user_agent_m10': 'Other / Other / Other', 'is_error_m10': True, 'is_suspicious_m10': False}]
(Background on this error at: https://sqlalche.me/e/14/f405); 108)
2025-04-03T18:56:22.670+0000 [INFO] Task exited with return code 1
2025-04-03T18:56:22.688+0000 [INFO] 0 downstream tasks scheduled from follow-on schedule check
