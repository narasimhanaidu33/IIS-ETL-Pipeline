[2025-04-03T16:42:54.710+0000] {taskinstance.py:1103} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: iis_etl.processing.transform scheduled__2025-04-02T00:00:00+00:00 [queued]>
[2025-04-03T16:42:54.717+0000] {taskinstance.py:1103} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: iis_etl.processing.transform scheduled__2025-04-02T00:00:00+00:00 [queued]>
[2025-04-03T16:42:54.718+0000] {taskinstance.py:1308} INFO - Starting attempt 2 of 4
[2025-04-03T16:42:54.726+0000] {taskinstance.py:1327} INFO - Executing <Task(PythonOperator): processing.transform> on 2025-04-02 00:00:00+00:00
[2025-04-03T16:42:54.734+0000] {standard_task_runner.py:57} INFO - Started process 59 to run task
[2025-04-03T16:42:54.739+0000] {standard_task_runner.py:84} INFO - Running: ['airflow', 'tasks', 'run', 'iis_etl', 'processing.transform', 'scheduled__2025-04-02T00:00:00+00:00', '--job-id', '7', '--raw', '--subdir', 'DAGS_FOLDER/iis_etl.py', '--cfg-path', '/tmp/tmpirblb0gh']
[2025-04-03T16:42:54.742+0000] {standard_task_runner.py:85} INFO - Job 7: Subtask processing.transform
[2025-04-03T16:42:54.777+0000] {task_command.py:410} INFO - Running <TaskInstance: iis_etl.processing.transform scheduled__2025-04-02T00:00:00+00:00 [running]> on host 2934a6d583dc
[2025-04-03T16:42:55.008+0000] {taskinstance.py:1547} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='iis_etl' AIRFLOW_CTX_TASK_ID='processing.transform' AIRFLOW_CTX_EXECUTION_DATE='2025-04-02T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-04-02T00:00:00+00:00'
[2025-04-03T16:42:55.014+0000] {iis_etl.py:175} ERROR - Transform failed: No data received from extract task
Traceback (most recent call last):
  File "/opt/airflow/dags/iis_etl.py", line 152, in transform
    raise ValueError("No data received from extract task")
ValueError: No data received from extract task
[2025-04-03T16:42:55.014+0000] {taskinstance.py:1824} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 181, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 198, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/iis_etl.py", line 152, in transform
    raise ValueError("No data received from extract task")
ValueError: No data received from extract task
[2025-04-03T16:42:55.018+0000] {taskinstance.py:1350} INFO - Marking task as UP_FOR_RETRY. dag_id=iis_etl, task_id=processing.transform, execution_date=20250402T000000, start_date=20250403T164254, end_date=20250403T164255
[2025-04-03T16:42:55.023+0000] {standard_task_runner.py:109} ERROR - Failed to execute job 7 for task processing.transform (No data received from extract task; 59)
[2025-04-03T16:42:55.045+0000] {local_task_job_runner.py:225} INFO - Task exited with return code 1
[2025-04-03T16:42:55.063+0000] {taskinstance.py:2653} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-04-03T17:55:04.773+0000] {taskinstance.py:1103} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: iis_etl.processing.transform scheduled__2025-04-02T00:00:00+00:00 [queued]>
[2025-04-03T17:55:04.779+0000] {taskinstance.py:1103} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: iis_etl.processing.transform scheduled__2025-04-02T00:00:00+00:00 [queued]>
[2025-04-03T17:55:04.779+0000] {taskinstance.py:1308} INFO - Starting attempt 2 of 4
[2025-04-03T17:55:04.786+0000] {taskinstance.py:1327} INFO - Executing <Task(PythonOperator): processing.transform> on 2025-04-02 00:00:00+00:00
[2025-04-03T17:55:04.789+0000] {standard_task_runner.py:57} INFO - Started process 66 to run task
[2025-04-03T17:55:04.792+0000] {standard_task_runner.py:84} INFO - Running: ['airflow', 'tasks', 'run', 'iis_etl', 'processing.transform', 'scheduled__2025-04-02T00:00:00+00:00', '--job-id', '9', '--raw', '--subdir', 'DAGS_FOLDER/iis_etl.py', '--cfg-path', '/tmp/tmpjzdimma5']
[2025-04-03T17:55:04.794+0000] {standard_task_runner.py:85} INFO - Job 9: Subtask processing.transform
[2025-04-03T17:55:04.819+0000] {task_command.py:410} INFO - Running <TaskInstance: iis_etl.processing.transform scheduled__2025-04-02T00:00:00+00:00 [running]> on host 33e2e884373f
[2025-04-03T17:55:04.986+0000] {taskinstance.py:1547} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='iis_etl' AIRFLOW_CTX_TASK_ID='processing.transform' AIRFLOW_CTX_EXECUTION_DATE='2025-04-02T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-04-02T00:00:00+00:00'
[2025-04-03T17:55:05.019+0000] {iis_etl.py:206} ERROR - Transform failed: Null values detected in required fields
Data sample: {'date': {0: Timestamp('2009-12-11 00:00:00'), 1: Timestamp('2009-12-11 00:00:00'), 2: Timestamp('2009-12-11 00:00:00'), 3: Timestamp('2009-12-11 00:00:00'), 4: Timestamp('2009-12-11 00:00:00')}, 'time': {0: '00:04:01', 1: '00:07:20', 2: '00:11:57', 3: '00:25:28', 4: '00:26:14'}, 's-ip': {0: '134.36.36.75', 1: '134.36.36.75', 2: '134.36.36.75', 3: '134.36.36.75', 4: '134.36.36.75'}, 'cs-method': {0: 'GET', 1: 'GET', 2: 'GET', 3: 'GET', 4: 'GET'}, 'cs-uri-stem': {0: '/Darwin/Plant.aspx', 1: '/getImageEx.aspx', 2: '/Darwin/Plant.aspx', 3: '/Darwin/Plant.aspx', 4: '/Darwin/Plant.aspx'}, 'cs-uri-query': {0: 'p=25&ix=274&pid=14&prcid=26&ppid=1502', 1: 'id=2819&cmp=85&thumb=220&x=0&y=0&thumbmode=W&readcache=yes&writecache=yes&project=25', 2: 'p=25&ix=176&pid=1&prcid=26&ppid=1502', 3: 'p=25&ix=128&pid=2&prcid=26&ppid=1502', 4: 'p=25&ix=449&pid=14&prcid=26&ppid=1502'}, 's-port': {0: 80, 1: 80, 2: 80, 3: 80, 4: 80}, 'cs-username': {0: '-', 1: '-', 2: '-', 3: '-', 4: '-'}, 'c-ip': {0: '67.195.115.229', 1: '66.249.65.134', 2: '67.195.115.229', 3: '67.195.115.229', 4: '67.195.115.229'}, 'cs(User-Agent)': {0: 'Mozilla/5.0+(compatible;+Yahoo!+Slurp/3.0;+http://help.yahoo.com/help/us/ysearch/slurp)', 1: 'Googlebot-Image/1.0', 2: 'Mozilla/5.0+(compatible;+Yahoo!+Slurp/3.0;+http://help.yahoo.com/help/us/ysearch/slurp)', 3: 'Mozilla/5.0+(compatible;+Yahoo!+Slurp/3.0;+http://help.yahoo.com/help/us/ysearch/slurp)', 4: 'Mozilla/5.0+(compatible;+Yahoo!+Slurp/3.0;+http://help.yahoo.com/help/us/ysearch/slurp)'}, 'sc-status': {0: 200.0, 1: 200.0, 2: 200.0, 3: 200.0, 4: 200.0}, 'sc-substatus': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 0.0}, 'sc-win32-status': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 0.0}, 'time-taken': {0: 631.0, 1: 1114.0, 2: 640.0, 3: 630.0, 4: 626.0}, 'timestamp': {0: Timestamp('2009-12-11 00:04:01+0000', tz='UTC'), 1: Timestamp('2009-12-11 00:07:20+0000', tz='UTC'), 2: Timestamp('2009-12-11 00:11:57+0000', tz='UTC'), 3: Timestamp('2009-12-11 00:25:28+0000', tz='UTC'), 4: Timestamp('2009-12-11 00:26:14+0000', tz='UTC')}, 'hour': {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 'time_period': {0: 'Night', 1: 'Night', 2: 'Night', 3: 'Night', 4: 'Night'}, 'ip_prefix': {0: 67.195, 1: 66.249, 2: 67.195, 3: 67.195, 4: 67.195}, 'user_agent': {0: 'Spider / Other / Slurp 3.0', 1: 'Spider / Other / Googlebot-Image 1.0', 2: 'Spider / Other / Slurp 3.0', 3: 'Spider / Other / Slurp 3.0', 4: 'Spider / Other / Slurp 3.0'}}
[2025-04-03T17:55:05.019+0000] {taskinstance.py:1824} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 181, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 198, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/iis_etl.py", line 184, in transform
    raise ValueError("Null values detected in required fields")
ValueError: Null values detected in required fields
[2025-04-03T17:55:05.024+0000] {taskinstance.py:1350} INFO - Marking task as UP_FOR_RETRY. dag_id=iis_etl, task_id=processing.transform, execution_date=20250402T000000, start_date=20250403T175504, end_date=20250403T175505
[2025-04-03T17:55:05.029+0000] {standard_task_runner.py:109} ERROR - Failed to execute job 9 for task processing.transform (Null values detected in required fields; 66)
[2025-04-03T17:55:05.063+0000] {local_task_job_runner.py:225} INFO - Task exited with return code 1
[2025-04-03T17:55:05.080+0000] {taskinstance.py:2653} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-04-03T18:06:28.699+0000] {taskinstance.py:1103} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: iis_etl.processing.transform scheduled__2025-04-02T00:00:00+00:00 [queued]>
[2025-04-03T18:06:28.705+0000] {taskinstance.py:1103} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: iis_etl.processing.transform scheduled__2025-04-02T00:00:00+00:00 [queued]>
[2025-04-03T18:06:28.705+0000] {taskinstance.py:1308} INFO - Starting attempt 2 of 4
[2025-04-03T18:06:28.712+0000] {taskinstance.py:1327} INFO - Executing <Task(PythonOperator): processing.transform> on 2025-04-02 00:00:00+00:00
[2025-04-03T18:06:28.714+0000] {standard_task_runner.py:57} INFO - Started process 60 to run task
[2025-04-03T18:06:28.717+0000] {standard_task_runner.py:84} INFO - Running: ['airflow', 'tasks', 'run', 'iis_etl', 'processing.transform', 'scheduled__2025-04-02T00:00:00+00:00', '--job-id', '7', '--raw', '--subdir', 'DAGS_FOLDER/iis_etl.py', '--cfg-path', '/tmp/tmp699b4q_l']
[2025-04-03T18:06:28.718+0000] {standard_task_runner.py:85} INFO - Job 7: Subtask processing.transform
[2025-04-03T18:06:28.742+0000] {task_command.py:410} INFO - Running <TaskInstance: iis_etl.processing.transform scheduled__2025-04-02T00:00:00+00:00 [running]> on host 9d773aeac6dd
[2025-04-03T18:06:28.871+0000] {taskinstance.py:1547} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='iis_etl' AIRFLOW_CTX_TASK_ID='processing.transform' AIRFLOW_CTX_EXECUTION_DATE='2025-04-02T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-04-02T00:00:00+00:00'
[2025-04-03T18:06:28.912+0000] {iis_etl.py:233} ERROR - Transform failed: unsupported operand type(s) for +: 'Timestamp' and 'str'
Data sample: {'date': {0: Timestamp('2009-12-13 00:00:00'), 1: Timestamp('2009-12-13 00:00:00'), 2: Timestamp('2009-12-13 00:00:00'), 3: Timestamp('2009-12-13 00:00:00'), 4: Timestamp('2009-12-13 00:00:00')}, 'time': {0: '00:04:51', 1: '00:20:59', 2: '00:22:58', 3: '00:26:06', 4: '00:27:28'}, 's-ip': {0: '134.36.36.75', 1: '134.36.36.75', 2: '134.36.36.75', 3: '134.36.36.75', 4: '134.36.36.75'}, 'cs-method': {0: 'GET', 1: 'GET', 2: 'GET', 3: 'GET', 4: 'GET'}, 'cs-uri-stem': {0: '/getImageEx.aspx', 1: '/Darwin/Plant.aspx', 2: '/Darwin/Plant.aspx', 3: '/Darwin/Plant.aspx', 4: '/Darwin/Plant.aspx'}, 'cs-uri-query': {0: 'id=3316&cmp=85&thumb=220&x=0&y=0&thumbmode=W&readcache=yes&writecache=yes&project=25', 1: 'p=25&ix=80&pid=3&prcid=26&ppid=1502', 2: 'p=25&ix=804&pid=8&prcid=26&ppid=1502', 3: 'ix=545&pid=14&prcid=26&ppid=1502', 4: 'ix=153&pid=4&prcid=26&ppid=1502'}, 's-port': {0: 80, 1: 80, 2: 80, 3: 80, 4: 80}, 'cs-username': {0: '-', 1: '-', 2: '-', 3: '-', 4: '-'}, 'c-ip': {0: '66.249.65.172', 1: '216.129.119.10', 2: '216.129.119.10', 3: '216.129.119.10', 4: '216.129.119.10'}, 'cs(User-Agent)': {0: 'Googlebot-Image/1.0', 1: 'Mozilla/5.0+(Twiceler-0.9+http://www.cuil.com/twiceler/robot.html)', 2: 'Mozilla/5.0+(Twiceler-0.9+http://www.cuil.com/twiceler/robot.html)', 3: 'Mozilla/5.0+(Twiceler-0.9+http://www.cuil.com/twiceler/robot.html)', 4: 'Mozilla/5.0+(Twiceler-0.9+http://www.cuil.com/twiceler/robot.html)'}, 'sc-status': {0: 200, 1: 200, 2: 200, 3: 200, 4: 200}, 'sc-substatus': {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 'sc-win32-status': {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 'time-taken': {0: 1104, 1: 637, 2: 598, 3: 645, 4: 635}, 'timestamp': {0: Timestamp('2009-12-13 00:04:51+0000', tz='UTC'), 1: Timestamp('2009-12-13 00:20:59+0000', tz='UTC'), 2: Timestamp('2009-12-13 00:22:58+0000', tz='UTC'), 3: Timestamp('2009-12-13 00:26:06+0000', tz='UTC'), 4: Timestamp('2009-12-13 00:27:28+0000', tz='UTC')}, 'hour': {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 'time_period': {0: 'Night', 1: 'Night', 2: 'Night', 3: 'Night', 4: 'Night'}, 'ip_prefix': {0: 66.249, 1: 216.129, 2: 216.129, 3: 216.129, 4: 216.129}, 'user_agent': {0: 'Spider / Other / Googlebot-Image 1.0', 1: 'Spider / Other / robot', 2: 'Spider / Other / robot', 3: 'Spider / Other / robot', 4: 'Spider / Other / robot'}}
[2025-04-03T18:06:28.912+0000] {taskinstance.py:1824} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/ops/array_ops.py", line 166, in _na_arithmetic_op
    result = func(left, right)
TypeError: unsupported operand type(s) for +: 'Timestamp' and 'str'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 181, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 198, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/iis_etl.py", line 217, in transform
    is_suspicious=lambda x: (
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/frame.py", line 4486, in assign
    data[k] = com.apply_if_callable(v, data)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/common.py", line 358, in apply_if_callable
    return maybe_callable(obj, **kwargs)
  File "/opt/airflow/dags/iis_etl.py", line 215, in <lambda>
    timestamp=lambda x: pd.to_datetime(x['date'] + ' ' + x['time']),
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/ops/common.py", line 69, in new_method
    return method(self, other)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/arraylike.py", line 92, in __add__
    return self._arith_method(other, operator.add)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/series.py", line 5526, in _arith_method
    result = ops.arithmetic_op(lvalues, rvalues, op)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/ops/array_ops.py", line 224, in arithmetic_op
    res_values = _na_arithmetic_op(left, right, op)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/ops/array_ops.py", line 173, in _na_arithmetic_op
    result = _masked_arith_op(left, right, op)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/ops/array_ops.py", line 131, in _masked_arith_op
    result[mask] = op(xrav[mask], y)
TypeError: unsupported operand type(s) for +: 'Timestamp' and 'str'
[2025-04-03T18:06:28.920+0000] {taskinstance.py:1350} INFO - Marking task as UP_FOR_RETRY. dag_id=iis_etl, task_id=processing.transform, execution_date=20250402T000000, start_date=20250403T180628, end_date=20250403T180628
[2025-04-03T18:06:28.926+0000] {standard_task_runner.py:109} ERROR - Failed to execute job 7 for task processing.transform (unsupported operand type(s) for +: 'Timestamp' and 'str'; 60)
[2025-04-03T18:06:28.942+0000] {local_task_job_runner.py:225} INFO - Task exited with return code 1
[2025-04-03T18:06:28.963+0000] {taskinstance.py:2653} INFO - 0 downstream tasks scheduled from follow-on schedule check
2025-04-03T18:21:10.680+0000 [INFO] Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: iis_etl.processing.transform scheduled__2025-04-02T00:00:00+00:00 [queued]>
2025-04-03T18:21:10.693+0000 [INFO] Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: iis_etl.processing.transform scheduled__2025-04-02T00:00:00+00:00 [queued]>
2025-04-03T18:21:10.694+0000 [INFO] Starting attempt 2 of 4
2025-04-03T18:21:10.703+0000 [INFO] Executing <Task(PythonOperator): processing.transform> on 2025-04-02 00:00:00+00:00
2025-04-03T18:21:10.715+0000 [INFO] Started process 83 to run task
2025-04-03T18:21:10.729+0000 [INFO] Running: ['airflow', 'tasks', 'run', 'iis_etl', 'processing.transform', 'scheduled__2025-04-02T00:00:00+00:00', '--job-id', '14', '--raw', '--subdir', 'DAGS_FOLDER/iis_etl.py', '--cfg-path', '/tmp/tmpn2tz7oz2']
2025-04-03T18:21:10.734+0000 [INFO] Job 14: Subtask processing.transform
2025-04-03T18:21:10.775+0000 [INFO] Running <TaskInstance: iis_etl.processing.transform scheduled__2025-04-02T00:00:00+00:00 [running]> on host 828dc78d8deb
2025-04-03T18:21:11.073+0000 [INFO] Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='iis_etl' AIRFLOW_CTX_TASK_ID='processing.transform' AIRFLOW_CTX_EXECUTION_DATE='2025-04-02T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-04-02T00:00:00+00:00'
2025-04-03T18:21:11.215+0000 [ERROR] Transform failed: unsupported operand type(s) for +: 'Timestamp' and 'str'
Data sample: {'date': {0: Timestamp('2009-11-30 00:00:00'), 1: Timestamp('2009-11-30 00:00:00'), 2: Timestamp('2009-11-30 00:00:00'), 3: Timestamp('2009-11-30 00:00:00'), 4: Timestamp('2009-11-30 00:00:00')}, 'time': {0: '00:00:59', 1: '00:03:14', 2: '00:03:40', 3: '00:06:21', 4: '00:08:26'}, 's-ip': {0: '134.36.36.75', 1: '134.36.36.75', 2: '134.36.36.75', 3: '134.36.36.75', 4: '134.36.36.75'}, 'cs-method': {0: 'GET', 1: 'GET', 2: 'GET', 3: 'GET', 4: 'GET'}, 'cs-uri-stem': {0: '/Darwin/MyAccount.aspx', 1: '/Darwin/Image.aspx', 2: '/Darwin/Image.aspx', 3: '/Darwin/MyAccount.aspx', 4: '/Darwin/ImageCache/cache_sWdokce_1157.jpeg'}, 'cs-uri-query': {0: 'p=25&pid=471&prcid=62&ppid=1505', 1: 'p=25&ix=3170&pid=434&prcid=0&ppid=1505&pup=true', 2: 'p=25&ix=10002932&pid=876&prcid=0&ppid=1505&pup=true', 3: 'p=25&pid=478&prcid=62&ppid=1505', 4: '-'}, 's-port': {0: 80, 1: 80, 2: 80, 3: 80, 4: 80}, 'cs-username': {0: '-', 1: '-', 2: '-', 3: '-', 4: '-'}, 'c-ip': {0: '66.249.65.245', 1: '66.249.65.245', 2: '66.249.65.245', 3: '66.249.65.245', 4: '76.119.140.119'}, 'cs(User-Agent)': {0: 'Mozilla/5.0+(compatible;+Googlebot/2.1;++http://www.google.com/bot.html)', 1: 'Mozilla/5.0+(compatible;+Googlebot/2.1;++http://www.google.com/bot.html)', 2: 'Mozilla/5.0+(compatible;+Googlebot/2.1;++http://www.google.com/bot.html)', 3: 'Mozilla/5.0+(compatible;+Googlebot/2.1;++http://www.google.com/bot.html)', 4: 'Mozilla/5.0+(Macintosh;+U;+Intel+Mac+OS+X+10_6_2;+en-us)+AppleWebKit/531.21.8+(KHTML,+like+Gecko)+Version/4.0.4+Safari/531.21.10'}, 'sc-status': {0: 200, 1: 200, 2: 200, 3: 200, 4: 200}, 'sc-substatus': {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 'sc-win32-status': {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 'time-taken': {0: 255, 1: 247, 2: 260, 3: 249, 4: 496}, 'timestamp': {0: Timestamp('2009-11-30 00:00:59+0000', tz='UTC'), 1: Timestamp('2009-11-30 00:03:14+0000', tz='UTC'), 2: Timestamp('2009-11-30 00:03:40+0000', tz='UTC'), 3: Timestamp('2009-11-30 00:06:21+0000', tz='UTC'), 4: Timestamp('2009-11-30 00:08:26+0000', tz='UTC')}, 'hour': {0: 0, 1: 0, 2: 0, 3: 0, 4: 0}, 'time_period': {0: 'Night', 1: 'Night', 2: 'Night', 3: 'Night', 4: 'Night'}, 'ip_prefix': {0: 66.249, 1: 66.249, 2: 66.249, 3: 66.249, 4: 76.119}, 'user_agent': {0: 'Spider / Other / Googlebot 2.1', 1: 'Spider / Other / Googlebot 2.1', 2: 'Spider / Other / Googlebot 2.1', 3: 'Spider / Other / Googlebot 2.1', 4: 'PC / Mac OS X 10.6.2 / Safari 4.0.4'}, 'is_error': {0: False, 1: False, 2: False, 3: False, 4: False}, 'is_suspicious': {0: False, 1: False, 2: False, 3: False, 4: False}}
2025-04-03T18:21:11.215+0000 [ERROR] Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/ops/array_ops.py", line 166, in _na_arithmetic_op
    result = func(left, right)
TypeError: unsupported operand type(s) for +: 'Timestamp' and 'str'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 181, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 198, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/iis_etl.py", line 254, in transform
    is_suspicious=lambda x: (
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/frame.py", line 4486, in assign
    data[k] = com.apply_if_callable(v, data)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/common.py", line 358, in apply_if_callable
    return maybe_callable(obj, **kwargs)
  File "/opt/airflow/dags/iis_etl.py", line 252, in <lambda>
    timestamp=lambda x: pd.to_datetime(x['date'] + ' ' + x['time']),
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/ops/common.py", line 69, in new_method
    return method(self, other)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/arraylike.py", line 92, in __add__
    return self._arith_method(other, operator.add)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/series.py", line 5526, in _arith_method
    result = ops.arithmetic_op(lvalues, rvalues, op)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/ops/array_ops.py", line 224, in arithmetic_op
    res_values = _na_arithmetic_op(left, right, op)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/ops/array_ops.py", line 173, in _na_arithmetic_op
    result = _masked_arith_op(left, right, op)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/ops/array_ops.py", line 131, in _masked_arith_op
    result[mask] = op(xrav[mask], y)
TypeError: unsupported operand type(s) for +: 'Timestamp' and 'str'
2025-04-03T18:21:11.224+0000 [INFO] Marking task as UP_FOR_RETRY. dag_id=iis_etl, task_id=processing.transform, execution_date=20250402T000000, start_date=20250403T182110, end_date=20250403T182111
2025-04-03T18:21:11.231+0000 [ERROR] Failed to execute job 14 for task processing.transform (unsupported operand type(s) for +: 'Timestamp' and 'str'; 83)
2025-04-03T18:21:11.279+0000 [INFO] Task exited with return code 1
2025-04-03T18:21:11.350+0000 [INFO] 0 downstream tasks scheduled from follow-on schedule check
